(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{422:function(e,n){},535:function(e,n,t){},536:function(e,n,t){},585:function(e,n,t){"use strict";t.r(n);var r=t(610),c=t(630),i=t(1),a=t.n(i),s=t(14),o=t(20),l=t(609),u=t(225),d={global:function(e){return{body:{bg:Object(u.a)("gray.100","#1b1c1d")(e)}}}},b=Object(l.a)({colors:{highlight:{standard:"#7289da",hover:"#677bc4",active:"#5b6eae"},brandGray:{accent:"#8e9297",active:"#393c43",light:"#36393f",dark:"#303339",darker:"#202225",darkest:"#18191c",hover:"#32353b"},brandGreen:"#43b581",labelGray:"#72767d",menuRed:"#f04747",brandBorder:"#1A202C",accountBar:"#292b2f",memberList:"#2f3136",iconColor:"#b9bbbe",messageInput:"#40444b"},config:{initialColorMode:"dark"},styles:d,fonts:{body:"'Open Sans', sans-serif"}}),j={"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{background:"#2f3136",width:"10px"},"&::-webkit-scrollbar-thumb":{background:"brandGray.darker",borderRadius:"18px"}},h=t(111),x=t.n(h),f=t(197),O=x()(Object(f.persist)((function(e,n){return{current:null,setUser:function(n){return e({current:n})},logout:function(){return e({current:null})},isAuth:function(){return null!==n().current}}}),{name:"user-storage"})),p=t(354),g=t.n(p);function m(){return g()("/ws",{transports:["websocket"],upgrade:!1})}var v=x()((function(e){return{notifCount:0,requestCount:0,increment:function(){return e((function(e){return{notifCount:e.notifCount+1}}))},reset:function(){return e((function(){return{notifCount:0}}))},resetRequest:function(){return e((function(){return{requestCount:0}}))},setRequests:function(n){return e((function(){return{requestCount:n}}))},isPending:!1,toggleDisplay:function(){return e((function(e){return{isPending:!e.isPending}}))}}})),y=t(2);function w(e){var n=e.children,t=O((function(e){return e.current})),r=v((function(e){return e.increment}));return Object(i.useEffect)((function(){if(t){var e=function(){window.location.pathname.includes("/channels/me")||r()},n=function(){c.emit("toggleOffline"),c.disconnect()},c=m();return c.emit("toggleOnline"),c.emit("joinUser",null===t||void 0===t?void 0:t.id),c.on("push_to_top",(function(){e()})),c.on("send_request",(function(){e()})),window.addEventListener("beforeunload",n),function(){return n()}}}),[t,r]),Object(y.jsx)(y.Fragment,{children:n})}var C=t(355),k=new s.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1/0,cacheTime:0}}});function S(e){var n=e.children;return Object(y.jsxs)(s.QueryClientProvider,{client:k,children:[Object(y.jsx)(C.ReactQueryDevtools,{}),Object(y.jsx)(r.a,{}),Object(y.jsx)(c.a,{theme:b,children:Object(y.jsx)(w,{children:Object(y.jsx)(o.a,{children:n})})})]})}var I=t(73),z=t.n(I),_=t(41),G=t(10),R=t.n(G),A=t(16),T=t(6),Q=t(626),D=t(615),E=t(336),M=t(335),L=t(337),P=t(632),F=t(616),q=t(338),N=t(187),W=t(383),V=t(339),B=t(358),U=t.n(B).a.create({baseURL:"/api",withCredentials:!0});U.interceptors.response.use((function(e){return e}),(function(e){if(403===e.response.status)localStorage.removeItem("user-storage"),window.location.replace("/login");return Promise.reject(e)}));var H=function(e){return U.put("/account",e,{headers:{"Content-Type":"multipart/form-data"}})},Y=function(e){return U.post("/account/".concat(e,"/friend"))},Z=function(e){return U.delete("/account/".concat(e,"/friend"))},J=function(){return U.post("/account/logout")},K=function(e){return U.post("/account/reset-password",e)},$=t(24),X="guilds",ee="dms",ne="friends",te="requests",re=function(e){return"channels-".concat(e)},ce=function(e){return"members-".concat(e)};function ie(e){var n,t;if(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.errors){var r,c,i=null===e||void 0===e||null===(r=e.response)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.errors,a={};return i.forEach((function(e){var n=e.field,t=e.message;a[n]=t})),a}}var ae=t(624),se=t(332),oe=t(26),le=oe.d().shape({email:oe.f().required("Email is required").defined(),password:oe.f().required("Password is required").defined()}),ue=oe.d().shape({username:oe.f().min(3).max(30).trim().required("Username is required").defined(),email:oe.f().email().lowercase().required("Email is required").defined(),password:oe.f().min(6,"Password must be at least 6 characters long").max(150).required("Password is required").defined()}),de=oe.d().shape({email:oe.f().email().lowercase().required("Email is required").defined(),username:oe.f().min(3).max(30).trim().required("Username is required").defined()}),be=oe.d().shape({newPassword:oe.f().min(6,"Password must be at least 6 characters long").max(150).required("New password is required").defined(),confirmNewPassword:oe.f().oneOf([oe.e("newPassword"),void 0],"Passwords do not match").required("Confirm new password is required").defined()}),je=oe.d().shape({currentPassword:oe.f().required("Old Password is required").defined(),newPassword:oe.f().min(6,"Password must be at least 6 characters long").max(150).required("New password is required").defined(),confirmNewPassword:oe.f().oneOf([oe.e("newPassword"),void 0],"Passwords do not match").required("Confirm new password is required").defined()}),he=oe.d().shape({email:oe.f().email().lowercase().required("Email is required").defined()}),xe=t(29),fe=t(144),Oe=t(88),pe=t(331),ge=t(333),me=t(334),ve=["label"];function ye(e){var n=e.label,t=Object(fe.a)(e,ve),r=Object($.c)(t),c=Object(T.a)(r,2),i=c[0],a=c[1],s=a.error,o=a.touched;return Object(y.jsxs)(Oe.a,{mt:4,isInvalid:null!=s&&o,children:[Object(y.jsx)(pe.a,{htmlFor:i.name,children:Object(y.jsx)(se.a,{fontSize:"12px",textTransform:"uppercase",children:n})}),Object(y.jsx)(ge.a,Object(xe.a)(Object(xe.a)({bg:"brandGray.dark",borderColor:"black",borderRadius:"3px",focusBorderColor:"highlight.standard"},i),t)),Object(y.jsx)(me.b,{children:s})]})}function we(e){var n=e.isOpen,t=e.onClose,r=Object(Q.a)();function c(){return(c=Object(A.a)(R.a.mark((function e(n,c){var i,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.setErrors,e.prev=1,e.next=4,null;case 4:a=e.sent,a.data&&(r({title:"Changed Password",status:"success",duration:5e3,isClosable:!0}),t()),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),i(ie(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}return Object(y.jsxs)(ae.a,{isOpen:n,onClose:t,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{currentPassword:"",newPassword:"",confirmNewPassword:""},validationSchema:je,onSubmit:function(e,n){return c.apply(this,arguments)},children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",children:"Change your password"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{pb:6,children:[Object(y.jsx)(se.a,{children:"Enter your current password and a new password"}),Object(y.jsx)(ye,{label:"current password",name:"currentPassword",autoComplete:"password",type:"password"}),Object(y.jsx)(ye,{label:"new password",name:"newPassword",autoComplete:"password",type:"password"}),Object(y.jsx)(ye,{label:"confirm new password",name:"confirmNewPassword",autoComplete:"password",type:"password"})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:t,fontSize:"14px",mr:6,variant:"link",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:n,fontSize:"14px",children:"Done"})]})]})}})})]})}var Ce=t(628),ke=t(379),Se=function(e){return new Promise((function(n,t){var r=new Image;r.addEventListener("load",(function(){return n(r)})),r.addEventListener("error",(function(e){return t(e)})),r.setAttribute("crossOrigin","anonymous"),r.src=e}))};function Ie(e){return e*Math.PI/180}function ze(e,n){return _e.apply(this,arguments)}function _e(){return _e=Object(A.a)(R.a.mark((function e(n,t){var r,c,i,a,s,o,l,u=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:0,e.next=3,Se(n);case 3:return c=e.sent,i=document.createElement("canvas"),a=i.getContext("2d"),s=Math.max(c.width,c.height),o=s/2*Math.sqrt(2)*2,i.width=o,i.height=o,a.translate(o/2,o/2),a.rotate(Ie(r)),a.translate(-o/2,-o/2),a.drawImage(c,o/2-.5*c.width,o/2-.5*c.height),l=a.getImageData(0,0,o,o),i.width=t.width,i.height=t.height,a.putImageData(l,Math.round(0-o/2+.5*c.width-t.x),Math.round(0-o/2+.5*c.height-t.y)),e.abrupt("return",new Promise((function(e){i.toBlob((function(n){e(n)}),"image/jpeg")})));case 19:case"end":return e.stop()}}),e)}))),_e.apply(this,arguments)}function Ge(e){var n=e.isOpen,t=e.onClose,r=e.applyCrop,c=e.initialImage,a=Object(i.useState)({x:0,y:0}),s=Object(T.a)(a,2),o=s[0],l=s[1],u=Object(i.useState)(1),d=Object(T.a)(u,2),b=d[0],j=d[1],h=Object(i.useState)(null),x=Object(T.a)(h,2),f=x[0],O=x[1],p=Object(i.useCallback)((function(e,n){O(n)}),[]),g=Object(i.useCallback)(Object(A.a)(R.a.mark((function e(){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze(c,f);case 3:n=e.sent,r(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[f,c,r]);return Object(y.jsxs)(ae.a,{isOpen:n,onClose:t,isCentered:!0,closeOnOverlayClick:!1,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)(ae.f,{fontWeight:"bold",children:"EDIT MEDIA"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(M.a,{h:"400px",overflow:"hidden",position:"relative",children:Object(y.jsx)(ke.a,{image:c,crop:o,zoom:b,aspect:1,cropShape:"round",onCropChange:l,onCropComplete:p,onZoomChange:j})}),Object(y.jsxs)(Ce.a,{"aria-label":"zoom",min:1,max:3,step:.01,value:b,onChange:function(e){return j(e)},my:"4",children:[Object(y.jsx)(Ce.d,{children:Object(y.jsx)(Ce.b,{})}),Object(y.jsx)(Ce.c,{})]})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:t,fontSize:"14px",mr:6,variant:"link",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",fontSize:"14px",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},onClick:g,children:"Apply"})]})]})]})}function Re(){var e=Object(s.useQuery)("account",(function(){return U.get("/account").then((function(e){return e.data}))})).data,n=O((function(e){return e.logout})),t=O((function(e){return e.setUser})),r=Object(s.useQueryClient)(),c=Object(_.g)(),a=Object(Q.a)(),o=Object(D.a)(),l=o.isOpen,u=o.onOpen,d=o.onClose,b=Object(D.a)(),j=b.isOpen,h=b.onOpen,x=b.onClose,f=Object(i.useRef)(null),p=Object(i.useState)((null===e||void 0===e?void 0:e.image)||""),g=Object(T.a)(p,2),m=g[0],v=g[1],w=Object(i.useState)(""),C=Object(T.a)(w,2),k=C[0],S=C[1],I=Object(i.useState)(null),z=Object(T.a)(I,2),G=z[0],B=z[1];function Y(){return(Y=Object(A.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:t=e.sent,t.data&&(r.clear(),n(),c.push("/"));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return(Z=Object(A.a)(R.a.mark((function e(n,r){var c,i,s,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.setErrors,e.prev=1,(i=new FormData).append("email",n.email),i.append("username",n.username),i.append("image",null!==G&&void 0!==G?G:m),e.next=8,H(i);case 8:s=e.sent,(o=s.data)&&(t(o),a({title:"Account updated",status:"success",duration:3e3,isClosable:!0})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),c(ie(e.t0));case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function K(e){e.currentTarget.files&&(S(URL.createObjectURL(e.currentTarget.files[0])),h())}return e?Object(y.jsxs)(E.a,{minHeight:"100vh",width:"full",align:"center",justifyContent:"center",children:[Object(y.jsxs)(M.a,{px:4,width:"full",maxWidth:"500px",children:[Object(y.jsx)(E.a,{mb:"4",justify:"center",children:Object(y.jsx)(L.a,{fontSize:"24px",children:"MY ACCOUNT"})}),Object(y.jsxs)(M.a,{p:4,borderRadius:4,background:"brandGray.light",children:[Object(y.jsx)(M.a,{children:Object(y.jsx)($.b,{initialValues:{email:e.email,username:e.username,image:null},validationSchema:de,onSubmit:function(e,n){return Z.apply(this,arguments)},children:function(n){var t=n.isSubmitting,r=n.values;return Object(y.jsxs)($.a,{children:[Object(y.jsxs)(E.a,{mb:"4",justify:"center",children:[Object(y.jsx)(P.a,{label:"Change Avatar","aria-label":"Change Avatar",children:Object(y.jsx)(F.a,{size:"xl",name:e.username,src:m||e.image,_hover:{cursor:"pointer",opacity:.5},onClick:function(){return f.current.click()}})}),Object(y.jsx)("input",{type:"file",name:"image",accept:"image/*",ref:f,hidden:!0,onChange:K})]}),Object(y.jsxs)(M.a,{my:4,children:[Object(y.jsx)(ye,{value:r.email,type:"email",placeholder:"Email",label:"Email",name:"email",autoComplete:"email"}),Object(y.jsx)(ye,{value:r.username,placeholder:"Username",label:"Username",name:"username",autoComplete:"username"}),Object(y.jsxs)(E.a,{my:8,align:"end",children:[Object(y.jsx)(q.a,{}),Object(y.jsx)(N.a,{mr:4,colorScheme:"white",variant:"outline",onClick:c.goBack,fontSize:"14px",children:"Close"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{type:"submit",colorScheme:"green",isLoading:t,fontSize:"14px",children:"Update"})})]})]})]})}})}),Object(y.jsx)(V.a,{my:"4"}),Object(y.jsx)(E.a,{children:Object(y.jsx)(L.a,{fontSize:"18px",children:"PASSWORD AND AUTHENTICATION"})}),Object(y.jsxs)(E.a,{mt:"4",children:[Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},onClick:u,fontSize:"14px",children:"Change Password"}),Object(y.jsx)(q.a,{}),Object(y.jsx)(N.a,{colorScheme:"red",variant:"outline",onClick:function(){return Y.apply(this,arguments)},fontSize:"14px",children:"Logout"})]})]})]}),l&&Object(y.jsx)(we,{isOpen:l,onClose:d}),j&&Object(y.jsx)(Ge,{isOpen:j,onClose:x,initialImage:k,applyCrop:function(e){v(URL.createObjectURL(e)),B(new File([e],"avatar")),x()}})]}):null}var Ae=["component"];function Te(e){var n=e.component,t=Object(fe.a)(e,Ae),r=O((function(e){return e.current})),c=JSON.parse(localStorage.getItem("user-storage"));return Object(y.jsx)(_.b,Object(xe.a)(Object(xe.a)({},t),{},{render:function(e){var t;return r||(null===c||void 0===c||null===(t=c.state)||void 0===t?void 0:t.current)?Object(y.jsx)(n,Object(xe.a)({},e)):Object(y.jsx)(_.a,{to:"/login"})}}))}var Qe=t(617);function De(){var e=Object(_.g)(),n=Object(Q.a)(),t=function(){var t=Object(A.a)(R.a.mark((function t(r,c){var i,a;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.setErrors,t.prev=1,t.next=4,s=r.email,U.post("/account/forgot-password",{email:s});case 4:a=t.sent,a.data&&(e.push("/"),n({title:"Reset Password",description:"If an account with that email exists, we sent you an email",status:"success",duration:5e3,isClosable:!0})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),i(ie(t.t0));case 12:case"end":return t.stop()}var s}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}();return Object(y.jsx)(E.a,{minHeight:"100vh",width:"full",align:"center",justifyContent:"center",children:Object(y.jsxs)(M.a,{px:4,width:"full",maxWidth:"500px",textAlign:"center",children:[Object(y.jsx)(E.a,{mb:"4",justify:"center",children:Object(y.jsx)(Qe.a,{src:"/logo.png",w:"80px"})}),Object(y.jsxs)(M.a,{p:4,borderRadius:4,background:"brandGray.light",children:[Object(y.jsx)(M.a,{textAlign:"center",children:Object(y.jsx)(L.a,{fontSize:"24px",children:"Forgot Password"})}),Object(y.jsx)(M.a,{my:4,textAlign:"left",children:Object(y.jsx)($.b,{initialValues:{email:""},validationSchema:he,onSubmit:t,children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ye,{label:"Email",name:"email",autoComplete:"email",type:"email"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",width:"full",mt:4,type:"submit",isLoading:n,_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},fontSize:"14px",children:"Send Mail"})]})}})})]})]})})}var Ee=t(186);function Me(e){var n=e.showLastColumn,t=void 0!==n&&n,r=e.children;return Object(y.jsx)(Ee.a,{height:"100vh",templateColumns:"75px 240px 1fr ".concat(t?"240px":""," "),templateRows:"auto 1fr auto",bg:"brandGray.light",children:r})}var Le=t(593),Pe=function(e,n,t){return U.post("/messages/".concat(e),n,{headers:{"Content-Type":"multipart/form-data"}})},Fe=function(e){return U.delete("/messages/".concat(e))},qe=function(e,n){return U.put("/messages/".concat(e),{text:n})},Ne=t(21),We=x()((function(e,n){return{typing:[],addTyping:function(n){e((function(e){return{typing:[].concat(Object(Ne.a)(e.typing),[n])}}))},removeTyping:function(n){e((function(e){return{typing:Object(Ne.a)(e.typing.filter((function(e){return e!==n})))}}))},reset:function(){e((function(){return{typing:[]}}))}}}));var Ve=t(95),Be=function(e){return U.post("/channels/".concat(e,"/dm"))},Ue=function(e){return U.delete("/channels/".concat(e,"/dm"))},He=function(e){return U.post("/guilds/create",e)},Ye=function(e){return U.post("/guilds/join",e)},Ze=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return U.get("/guilds/".concat(e,"/invite").concat(n?"?isPermanent=true":""))},Je=function(e){return U.delete("/guilds/".concat(e,"/invite"))},Ke=function(e){return U.get("/guilds/".concat(e,"/members"))},$e=function(e,n){return U.put("/guilds/".concat(e),n,{headers:{"Content-Type":"multipart/form-data"}})},Xe=function(e){return U.delete("/guilds/".concat(e,"/delete"))},en=function(e,n){return U.put("/guilds/".concat(e,"/member"),n)},nn=function(e,n){return U.post("/guilds/".concat(e,"/kick"),{memberId:n})},tn=function(e,n){return U.post("/guilds/".concat(e,"/bans"),{memberId:n})},rn=function(e,n){return U.delete("guilds/".concat(e,"/bans"),{data:{memberId:n}})};function cn(e){var n=e.member,t=e.isOpen,r=e.onClose,c=e.isBan,i=Object(_.i)().guildId,a=Object(s.useQueryClient)(),o=c?"Ban ":"Kick ";function l(){return(l=Object(A.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r(),!c){e.next=7;break}return e.next=4,tn(i,n.id);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,nn(i,n.id);case 9:e.t0=e.sent;case 10:t=e.t0,t.data&&a.invalidateQueries(ce(i));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsxs)(ae.f,{textTransform:"uppercase",fontWeight:"bold",fontSize:"14px",mb:0,pb:0,children:[o,"'",n.username,"'"]}),Object(y.jsx)(ae.b,{children:Object(y.jsxs)(se.a,{mb:"4",children:["Are you sure you want to ",o.toLocaleLowerCase()," @",n.username,"?",!c&&" They will be able to rejoin again with a new invite."]})}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{colorScheme:"red",fontSize:"14px",onClick:function(){return l.apply(this,arguments)},children:o})})]})]})]})}function an(e){var n=e.id,t=e.isOpen,r=e.onClose,c=function(e){var n=Object(s.useQuery)(ne).data;return null===n||void 0===n?void 0:n.find((function(n){return n.id===e}))}(n),i=Object(s.useQueryClient)();function a(){return(a=Object(A.a)(R.a.mark((function e(){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(),e.next=3,Z(n);case 3:t=e.sent,t.data&&i.setQueryData(ne,(function(e){return null===e||void 0===e?void 0:e.filter((function(e){return e.id!==n}))}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsxs)(ae.f,{textTransform:"uppercase",fontWeight:"bold",mb:0,pb:0,children:["Remove '",null===c||void 0===c?void 0:c.username,"'"]}),Object(y.jsx)(ae.b,{children:Object(y.jsxs)(se.a,{mb:"4",children:["Are you sure you want to permanently remove ",Object(y.jsx)("b",{children:null===c||void 0===c?void 0:c.username})," ","from your friends?"]})}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{colorScheme:"red",fontSize:"14px",onClick:function(){return a.apply(this,arguments)},children:"Remove Friend"})})]})]})]})}var sn=t(50);function on(e){var n=e.member,t=e.isOwner,r=e.id,c=Object(_.g)(),a=Object(D.a)(),s=a.isOpen,o=a.onOpen,l=a.onClose,u=Object(D.a)(),d=u.isOpen,b=u.onOpen,j=u.onClose,h=Object(i.useState)(!1),x=Object(T.a)(h,2),f=x[0],O=x[1],p=function(){var e=Object(A.a)(R.a.mark((function e(){var t,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be(n.id);case 2:t=e.sent,(r=t.data)&&c.push("/channels/me/".concat(r.id));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(A.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.isFriend){e.next=5;break}return e.next=3,Y(n.id);case 3:e.next=6;break;case 5:o();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(sn.b,{id:r,theme:sn.c.dark,children:[Object(y.jsx)(sn.a,{onClick:p,className:"menu-item",children:Object(y.jsx)(E.a,{align:"center",justify:"space-between",w:"full",children:Object(y.jsx)(se.a,{children:"Message"})})}),Object(y.jsx)(sn.a,{onClick:g,className:"menu-item",children:Object(y.jsx)(E.a,{align:"center",justify:"space-between",w:"full",children:Object(y.jsxs)(se.a,{children:[n.isFriend?"Remove":"Add"," Friend"]})})}),t&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(sn.a,{onClick:function(){O(!1),b()},className:"delete-item",children:Object(y.jsx)(E.a,{align:"center",justify:"space-between",w:"full",children:Object(y.jsxs)(se.a,{children:["Kick ",n.username]})})}),Object(y.jsx)(sn.a,{onClick:function(){O(!0),b()},className:"delete-item",children:Object(y.jsx)(E.a,{align:"center",justify:"space-between",w:"full",children:Object(y.jsxs)(se.a,{children:["Ban ",n.username]})})})]})]}),s&&Object(y.jsx)(an,{id:n.id,isOpen:!0,onClose:l}),d&&Object(y.jsx)(cn,{member:n,isOpen:d,isBan:f,onClose:j})]})}var ln=t(107),un=t.n(ln),dn=t(365),bn=t.n(dn);function jn(e){return un()(e).calendar()}function hn(e){return un()(e).format("MMMM D, YYYY")}function xn(e){var n=e.message,t=e.isOpen,r=e.onClose;function c(){return(c=Object(A.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(),e.next=3,Fe(n.id);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)(ae.f,{fontWeight:"bold",mb:0,pb:0,children:"Delete Message"}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(se.a,{mb:"4",children:"Are you sure you want to delete this message?"}),Object(y.jsx)(E.a,{alignItems:"center",my:"2",mr:"1",justify:"space-between",boxShadow:"dark-lg",py:2,children:Object(y.jsxs)(E.a,{children:[Object(y.jsx)(F.a,{h:"40px",w:"40px",ml:"4",mt:"1",src:n.user.image}),Object(y.jsxs)(M.a,{ml:"3",children:[Object(y.jsxs)(E.a,{alignItems:"center",children:[Object(y.jsx)(se.a,{children:n.user.username}),Object(y.jsx)(se.a,{fontSize:"12px",color:"brandGray.accent",ml:"3",children:jn(n.createdAt)})]}),Object(y.jsx)(se.a,{children:n.text})]})]})})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{colorScheme:"red",fontSize:"14px",onClick:function(){return c.apply(this,arguments)},children:"Delete"})})]})]})]})}function fn(e){var n=e.message,t=e.isOpen,r=e.onClose,c=Object(i.useState)(n.text),a=Object(T.a)(c,2),s=a[0],o=a[1];function l(){return(l=Object(A.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&s.trim()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,qe(n.id,s.trim());case 4:r();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)(ae.f,{fontWeight:"bold",mb:0,pb:0,children:"Edit Message"}),Object(y.jsx)(ae.b,{children:Object(y.jsx)(E.a,{alignItems:"center",my:"2",mr:"1",justify:"space-between",boxShadow:"dark-lg",py:2,children:Object(y.jsxs)(E.a,{alignItems:"center",children:[Object(y.jsx)(F.a,{h:"40px",w:"40px",ml:"4",src:n.user.image}),Object(y.jsxs)(M.a,{ml:"3",children:[Object(y.jsxs)(E.a,{alignItems:"center",children:[Object(y.jsx)(se.a,{children:n.user.username}),Object(y.jsx)(se.a,{fontSize:"12px",color:"brandGray.accent",ml:"3",children:jn(n.createdAt)})]}),Object(y.jsx)(ge.a,{value:s,onChange:function(e){return o(e.target.value)},bg:"brandGray.dark",borderColor:"black",borderRadius:"3px",focusBorderColor:"none"})]})]})})}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{colorScheme:"green",fontSize:"14px",onClick:function(){return l.apply(this,arguments)},children:"Save"})})]})]})]})}un.a.extend(bn.a);var On=t(629);function pn(e){var n,t=e.member,r=e.children;return Object(y.jsxs)(On.a,{isLazy:!0,placement:"right-start",children:[Object(y.jsx)(On.e,{children:r}),Object(y.jsxs)(On.b,{w:"80%",children:[Object(y.jsx)(On.d,{bg:"brandGray.darker",borderRadius:"md",children:Object(y.jsx)(E.a,{mt:2,align:"center",justify:"center",children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(F.a,{src:t.image,size:"xl",children:Object(y.jsx)(F.b,{boxSize:"0.9em",bg:t.isOnline?"green.500":"gray.500"})}),Object(y.jsx)(se.a,{mt:2,textAlign:"center",color:"#fff",fontWeight:"semibold",children:null!==(n=t.nickname)&&void 0!==n?n:t.username}),t.nickname&&Object(y.jsx)(se.a,{textAlign:"center",children:t.username})]})})}),Object(y.jsx)(On.c,{bg:"brandGray.dark",children:Object(y.jsx)(se.a,{textColor:"brandGray.accent",fontSize:"12px",textAlign:"center",children:"Right click user for more actions"})})]})]})}function gn(e){var n=Object(s.useQuery)(X).data;return null===n||void 0===n?void 0:n.find((function(n){return n.id===e}))}var mn=t(44),vn=t(98),yn=t(113);t(535);function wn(e){var n=e.message,t=n.url,r=n.text,c=n.filetype,i=n.createdAt,a=n.updatedAt;if(t&&c){if(c.startsWith("image/"))return Object(y.jsx)(M.a,{boxSize:"sm",my:"2",h:"full",children:Object(y.jsx)(Qe.a,{fit:"contain",src:t,alt:"",borderRadius:"md"})});if(c.startsWith("audio/"))return Object(y.jsx)(M.a,{my:"2",children:Object(y.jsx)("audio",{controls:!0,children:Object(y.jsx)("source",{src:t,type:c})})})}return Object(y.jsxs)(E.a,{alignItems:"center",children:[Object(y.jsx)(se.a,{children:r}),i!==a&&Object(y.jsx)(se.a,{fontSize:"10px",ml:"1",color:"labelGray",children:"(edited)"})]})}function Cn(e){var n,t,r,c=e.message,a=e.isCompact,s=void 0!==a&&a,o=Object(i.useState)(!1),l=Object(T.a)(o,2),u=l[0],d=l[1],b=O((function(e){return e.current})),j=(null===b||void 0===b?void 0:b.id)===c.user.id,h=gn(Object(_.i)().guildId),x=void 0!==h&&h.ownerId===(null===b||void 0===b?void 0:b.id),f=j||x||c.url,p=Object(D.a)(),g=p.isOpen,m=p.onOpen,v=p.onClose,w=Object(D.a)(),C=w.isOpen,k=w.onOpen,S=w.onClose,I="".concat(c.user.id,"-").concat(Math.random().toString(36).substr(2,5)),z=Object(sn.d)({id:c.id}).show,G=Object(sn.d)({id:I}).show;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(E.a,{alignItems:"center",mr:"1",mt:s?"0":"3",_hover:{bg:"brandGray.hover"},justify:"space-between",onMouseLeave:function(){return d(!1)},onMouseEnter:function(){return d(!0)},children:Object(y.jsx)(E.a,{w:"full",children:s?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(M.a,{ml:"3",minW:"44px",textAlign:"center",children:Object(y.jsx)(se.a,{fontSize:"10px",color:"brandGray.accent",mt:"1",hidden:!u,children:(r=c.createdAt,un()(r).format("h:mm A"))})}),Object(y.jsx)(M.a,{ml:"3",w:"full",onContextMenu:z,children:Object(y.jsx)(wn,{message:c})}),u&&f?Object(y.jsx)(M.a,{onClick:z,mr:"2",_hover:{cursor:"pointer"},h:"5px",children:Object(y.jsx)(mn.b,{})}):Object(y.jsx)(M.a,{mr:"6"})]}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(pn,{member:c.user,children:Object(y.jsx)(F.a,{h:"40px",w:"40px",ml:"4",mt:"1",src:c.user.image,_hover:{cursor:"pointer"},onContextMenu:function(e){j||G(e)}})}),Object(y.jsxs)(M.a,{ml:"3",w:"full",onContextMenu:z,children:[Object(y.jsxs)(E.a,{alignItems:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{alignItems:"center",children:[Object(y.jsx)(se.a,{color:null!==(n=c.user.color)&&void 0!==n?n:void 0,children:null!==(t=c.user.nickname)&&void 0!==t?t:c.user.username}),Object(y.jsx)(se.a,{fontSize:"12px",color:"brandGray.accent",ml:"2",children:jn(c.createdAt)})]}),u&&f&&Object(y.jsx)(M.a,{onClick:z,mr:"2",_hover:{cursor:"pointer"},children:Object(y.jsx)(mn.b,{})})]}),Object(y.jsx)(wn,{message:c})]})]})})}),f&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(sn.b,{id:c.id,theme:sn.c.dark,children:[c.filetype?Object(y.jsx)(sn.a,{className:"menu-item",onClick:function(){c.url&&function(e){var n=window.open(e,"_blank","noopener,noreferrer");n&&(n.opener=null)}(c.url)},children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",w:"full",children:[Object(y.jsx)(se.a,{children:"Open Link"}),Object(y.jsx)(Ve.a,{as:vn.b})]})}):j?Object(y.jsx)(sn.a,{className:"menu-item",onClick:k,children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",w:"full",children:[Object(y.jsx)(se.a,{children:"Edit Message"}),Object(y.jsx)(Ve.a,{as:yn.b})]})}):null,(j||x)&&Object(y.jsx)(sn.a,{onClick:m,className:"delete-item",children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",w:"full",children:[Object(y.jsx)(se.a,{children:"Delete Message"}),Object(y.jsx)(Ve.a,{as:mn.e})]})})]}),g&&Object(y.jsx)(xn,{message:c,isOpen:g,onClose:v}),C&&Object(y.jsx)(fn,{message:c,isOpen:C,onClose:S})]}),!j&&Object(y.jsx)(on,{member:c.user,isOwner:x,id:I})]})}function kn(e){var n=e.date;return Object(y.jsxs)(E.a,{textAlign:"center",align:"center",mt:"2",mx:"4",children:[Object(y.jsx)(V.a,{}),Object(y.jsx)(se.a,{w:["75%","75%","75%","40%","25%"],fontSize:"12px",color:"brandGray.accent",children:hn(n)}),Object(y.jsx)(V.a,{})]},n)}function Sn(e,n){var t=Object(s.useQuery)(n).data;return null===t||void 0===t?void 0:t.find((function(n){return n.id===e}))}function In(e){var n=Object(s.useQuery)(ee).data;return null===n||void 0===n?void 0:n.find((function(n){return n.id===e}))}function zn(){return void 0===Object(_.i)().guildId?Object(y.jsx)(Gn,{}):Object(y.jsx)(_n,{})}function _n(){var e=Object(_.i)(),n=e.guildId,t=Sn(e.channelId,re(n));return Object(y.jsx)(E.a,{alignItems:"center",mb:"2",justify:"center",children:Object(y.jsxs)(M.a,{textAlign:"center",children:[Object(y.jsxs)(L.a,{children:["Welcome to #",null===t||void 0===t?void 0:t.name]}),Object(y.jsxs)(se.a,{children:["This is the start of the #",null===t||void 0===t?void 0:t.name," channel"]})]})})}function Gn(){var e=In(Object(_.i)().channelId);return Object(y.jsxs)(M.a,{m:"4",children:[Object(y.jsx)(M.a,{h:"40px"}),Object(y.jsx)(F.a,{h:"80px",w:"80px",src:null===e||void 0===e?void 0:e.user.image}),Object(y.jsx)(L.a,{mt:2,children:null===e||void 0===e?void 0:e.user.username}),Object(y.jsxs)(se.a,{textColor:"brandGray.accent",children:["This is the beginning of your direct message history with @",null===e||void 0===e?void 0:e.user.username]}),Object(y.jsx)(V.a,{mt:2})]})}var Rn=t(366),An={"&::-webkit-scrollbar":{width:"0"}};function Tn(e){var n=e.children;return Object(y.jsx)(Ee.b,{id:"chatGrid",gridColumn:3,gridRow:"2",bg:"brandGray.light",mr:"5px",display:"flex",flexDirection:"column-reverse",overflowY:"auto",css:j,children:n})}function Qn(){var e=Object(_.i)().channelId,n=Object(i.useState)(!0),t=Object(T.a)(n,2),r=t[0],c=t[1],o="messages-".concat(e),l=Object(s.useInfiniteQuery)(o,function(){var n=Object(A.a)(R.a.mark((function n(t){var r,i,a,s;return R.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.pageParam,i=void 0===r?null:r,n.next=3,o=e,l=i,U.get("/messages/".concat(o,"/").concat(l?"?cursor=".concat(l):""));case 3:return a=n.sent,35!==(s=a.data).length&&c(!1),n.abrupt("return",s);case 7:case"end":return n.stop()}var o,l}),n)})));return function(e){return n.apply(this,arguments)}}(),{getNextPageParam:function(e){return r&&e.length?e[e.length-1].createdAt:""}}),u=l.data,d=l.isLoading;l.fetchNextPage;if(function(e,n){var t=O((function(e){return e.current})),r=We(),c=Object(s.useQueryClient)();Object(i.useEffect)((function(){r.reset();var i=m();return i.emit("joinChannel",e),i.on("new_message",(function(e){c.setQueryData(n,(function(n){return null===n||void 0===n||n.pages[0].unshift(e),n}))})),i.on("edit_message",(function(e){c.setQueryData(n,(function(n){var t=-1,r=-1;return null===n||void 0===n||n.pages.forEach((function(n,c){-1!==(r=n.findIndex((function(n){return n.id===e.id})))&&(t=c)})),-1!==t&&-1!==r&&(n.pages[t][r]=e),n}))})),i.on("delete_message",(function(e){c.setQueryData(n,(function(n){var t=-1;return null===n||void 0===n||n.pages.forEach((function(n,r){-1!==n.findIndex((function(n){return n.id===e.id}))&&(t=r)})),-1!==t&&(n.pages[t]=null===n||void 0===n?void 0:n.pages[t].filter((function(n){return n.id!==e.id}))),n}))})),i.on("addToTyping",(function(e){e!==(null===t||void 0===t?void 0:t.username)&&r.addTyping(e)})),i.on("removeFromTyping",(function(e){e!==(null===t||void 0===t?void 0:t.username)&&r.removeTyping(e)})),function(){i.emit("leaveRoom",e),i.disconnect()}}),[e,c,n,t])}(e,o),d)return Object(y.jsx)(Tn,{children:Object(y.jsx)(E.a,{align:"center",justify:"center",h:"full",children:Object(y.jsx)(Le.a,{size:"xl",thickness:"4px"})})});var b=function(e,n){return e.user.id===n.user.id&&(e.createdAt!==n.createdAt&&(t=e.createdAt,r=n.createdAt,un()(t).diff(un()(r),"minutes")<=5));var t,r},j=u?u.pages.flatMap((function(e){return e})):[];return Object(y.jsxs)(Tn,{children:[Object(y.jsx)(M.a,{h:"10px",mt:4}),Object(y.jsx)(M.a,{as:Rn.a,css:An,dataLength:j.length,style:{display:"flex",flexDirection:"column-reverse"},inverse:!0,hasMore:r,loader:j.length>0&&Object(y.jsx)(E.a,{align:"center",justify:"center",h:"50px",children:Object(y.jsx)(Le.a,{})}),scrollableTarget:"chatGrid",children:j.map((function(e,n){return Object(y.jsxs)(a.a.Fragment,{children:[Object(y.jsx)(Cn,{message:e,isCompact:b(e,j[Math.min(n+1,j.length-1)])}),(t=e.createdAt,r=j[Math.min(n+1,j.length-1)].createdAt,!un()(t).isSame(un()(r),"day")&&Object(y.jsx)(kn,{date:e.createdAt}))]},e.id);var t,r}))}),!r&&Object(y.jsx)(zn,{})]})}var Dn=t(341),En=t(620),Mn=t(378),Ln=(t(536),t(340)),Pn=t(635);function Fn(e){var n=e.label,t=e.position,r=e.disabled,c=void 0!==r&&r,i=e.children;return Object(y.jsx)(P.a,{hasArrow:!0,label:n,placement:t,isDisabled:c,bg:"brandGray.darkest",color:"white",fontWeight:"semibold",py:1,px:3,children:i})}var qn=["image/jpg","image/jpeg","audio/mp3","image/png"],Nn=oe.d().shape({file:oe.c().nullable().test("fileSize","The file is too large",(function(e){return(null===e||void 0===e?void 0:e.size)<5e6})).test("type","Only the following formats are accepted: Image and Audio",(function(e){return e&&qn.includes(e.type)}))});function Wn(){var e=Object(_.i)().channelId,n=Object(D.a)(),t=n.isOpen,r=n.onOpen,c=n.onClose,a=Object(i.useRef)(null),s=Object(i.useState)(!1),o=Object(T.a)(s,2),l=o[0],u=o[1],d=Object(i.useState)(0),b=Object(T.a)(d,2),j=b[0],h=b[1],x=Object(i.useState)({}),f=Object(T.a)(x,2),O=f[0],p=f[1],g=function(){p({}),h(0),c()},m=function(){var n=Object(A.a)(R.a.mark((function n(t){var c;return R.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:return u(!0),n.prev=3,n.next=6,Nn.validate({file:t});case 6:n.next=13;break;case 8:return n.prev=8,n.t0=n.catch(3),p(n.t0.errors),r(),n.abrupt("return");case 13:return(c=new FormData).append("file",t),n.next=17,Pe(e,c);case 17:case"end":return n.stop()}}),n,null,[[3,8]])})));return function(e){return n.apply(this,arguments)}}();return Object(y.jsxs)(Ln.a,{color:"iconColor",_hover:{cursor:"pointer",color:"#fcfcfc"},onClick:function(){return a.current.click()},children:[Object(y.jsx)(Ve.a,{as:yn.a,boxSize:"20px"}),Object(y.jsx)("input",{type:"file",ref:a,hidden:!0,disabled:l,onChange:function(){var e=Object(A.a)(R.a.mark((function e(n){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.currentTarget.files){e.next=2;break}return e.abrupt("return");case 2:m(n.currentTarget.files[0]).then((function(){u(!1),n.target.value=""}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),O&&Object(y.jsxs)(ae.a,{size:"sm",isOpen:t,onClose:g,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",textAlign:"center",children:[Object(y.jsx)(ae.f,{pb:"0",children:"Error Uploading File"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsxs)(se.a,{mb:"2",children:["Reason: ",O]}),Object(y.jsx)(se.a,{children:"Max file size is 5.00 MB"}),Object(y.jsx)(se.a,{children:"Only Images and mp3 allowed"})]})]})]}),j>0&&Object(y.jsx)(ae.a,{size:"sm",isOpen:j>0,closeOnOverlayClick:!1,onClose:g,isCentered:!0,children:Object(y.jsxs)(ae.d,{bg:"brandGray.darker",textAlign:"center",children:[Object(y.jsx)(ae.f,{pb:"0",children:"Upload Progress"}),Object(y.jsx)(ae.b,{children:Object(y.jsx)(Pn.a,{hasStripe:!0,isAnimated:!0,value:j})})]})})]})}function Vn(){var e=Object(i.useState)(""),n=Object(T.a)(e,2),t=n[0],r=n[1],c=Object(i.useState)(!1),a=Object(T.a)(c,2),o=a[0],l=a[1],u=Object(i.useState)(!1),d=Object(T.a)(u,2),b=d[0],j=d[1],h=Object(i.useRef)(),x=Object(_.i)(),f=x.guildId,p=x.channelId,g=void 0===f?ee:re(f),v=Object(s.useQuery)(g).data,w=null===v||void 0===v?void 0:v.find((function(e){return e.id===p})),C=m(),k=O((function(e){return e.current})),S=We((function(e){return e.typing}));function I(){return(I=Object(A.a)(R.a.mark((function e(n){var c,i;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.key){e.next=13;break}if(t&&t.trim()){e.next=3;break}return e.abrupt("return");case 3:return C.emit("stopTyping",p,null===k||void 0===k?void 0:k.username),l(!0),j(!1),(i=new FormData).append("text",t.trim()),e.next=10,Pe(p,i);case 10:r(""),l(!1),null===h||void 0===h||null===(c=h.current)||void 0===c||c.focus();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(Ee.b,{gridColumn:3,gridRow:3,px:"20px",pb:S.length>0?"0":"26px",bg:"brandGray.light",children:[Object(y.jsxs)(Dn.a,{size:"md",bg:"messageInput",alignItems:"center",borderRadius:"8px",children:[Object(y.jsx)(En.a,{as:Mn.a,minH:"40px",transition:"height none",overflow:"hidden",w:"100%",resize:"none",minRows:1,pl:"3rem",name:"text",placeholder:(null===w||void 0===w?void 0:w.user)?"Message @".concat(null===w||void 0===w?void 0:w.user.username):"Message #".concat(null===w||void 0===w?void 0:w.name),border:"0",_focus:{border:"0"},ref:h,isDisabled:o,value:t,onChange:function(e){var n=e.target.value;1!==n.trim().length||b?0===n.length&&(C.emit("stopTyping",p,null===k||void 0===k?void 0:k.username),j(!1)):(C.emit("startTyping",p,null===k||void 0===k?void 0:k.username),j(!0)),n.length<=2e3&&r(n)},onKeyDown:function(e){return I.apply(this,arguments)}}),Object(y.jsx)(Wn,{})]}),S.length>0&&Object(y.jsxs)(E.a,{align:"center",fontSize:"12px",my:1,children:[Object(y.jsxs)("div",{className:"typing-indicator",children:[Object(y.jsx)("span",{}),Object(y.jsx)("span",{}),Object(y.jsx)("span",{})]}),Object(y.jsx)(se.a,{ml:"1",fontWeight:"semibold",children:function(e){switch(e.length){case 1:return e[0];case 2:return"".concat(e[0]," and ").concat(e[1]);case 3:return"".concat(e[0],", ").concat(e[1]," and ").concat(e[2]);default:return"Several people"}}(S)}),Object(y.jsxs)(se.a,{ml:"1",children:[1===S.length?"is":"are"," typing..."," "]})]})]})}var Bn=t(342);function Un(){return Object(y.jsx)(M.a,{w:"8px",h:"8px",bg:"white",position:"absolute",borderRadius:"0 4px 4px 0",ml:"-4px",mt:"20px",left:0})}function Hn(){return Object(y.jsx)(M.a,{w:"8px",h:"8px",bg:"white",position:"absolute",borderRadius:"0 4px 4px 0",ml:"-4px",mt:"8px",left:"75px"})}function Yn(){return Object(y.jsx)(M.a,{w:"8px",h:"40px",bg:"white",position:"absolute",borderRadius:"0 4px 4px 0",ml:"-4px",left:0,mt:"4px"})}function Zn(){return Object(y.jsx)(M.a,{w:"8px",h:"24px",bg:"white",position:"absolute",borderRadius:"0 4px 4px 0",ml:"-4px",left:0,mt:"12px"})}function Jn(e){var n=e.guild,t=Object(_.h)().pathname.includes(n.id),r=Object(i.useState)(!1),c=Object(T.a)(r,2),a=c[0],l=c[1],u=Object(s.useQueryClient)();return Object(i.useEffect)((function(){n.hasNotification&&t&&u.setQueryData(X,(function(e){var t=null===e||void 0===e?void 0:e.findIndex((function(e){return e.id===n.id}));return-1!==t&&(e[t]=Object(xe.a)(Object(xe.a)({},e[t]),{},{hasNotification:!1})),e}))})),Object(y.jsxs)(E.a,{mb:"2",justify:"center",children:[t&&Object(y.jsx)(Yn,{}),a&&Object(y.jsx)(Zn,{}),n.hasNotification&&Object(y.jsx)(Un,{}),Object(y.jsx)(Fn,{label:n.name,position:"right",children:Object(y.jsx)(o.b,{to:"/channels/".concat(n.id,"/").concat(n.default_channel_id),children:n.icon?Object(y.jsx)(F.a,{src:n.icon,borderRadius:t?"35%":"50%",_hover:{borderRadius:"35%"},name:n.name,color:"#fff",bg:"brandGray.light",onMouseLeave:function(){return l(!1)},onMouseEnter:function(){return l(!0)}}):Object(y.jsx)(E.a,{justify:"center",align:"center",bg:t?"highlight.standard":"brandGray.light",borderRadius:t?"35%":"50%",h:"48px",w:"48px",color:t?"white":void 0,fontSize:"20px",_hover:{borderRadius:"35%",bg:"highlight.standard",color:"white"},onMouseLeave:function(){return l(!1)},onMouseEnter:function(){return l(!0)},children:n.name[0]})})})]})}var Kn=t(351),$n=oe.d().shape({name:oe.f().min(3).max(30).required()});function Xn(e){var n=e.isOpen,t=e.onClose,r=Object(i.useState)("START"),c=Object(T.a)(r,2),a=c[0],s=c[1],o=function(){return s("START")},l=function(){s("START"),t()};return Object(y.jsxs)(ae.a,{isOpen:n,onClose:l,isCentered:!0,size:"sm",children:[Object(y.jsx)(ae.g,{}),"INVITE"===a&&Object(y.jsx)(et,{goBack:o,submitClose:l}),"CREATE"===a&&Object(y.jsx)(nt,{goBack:o,submitClose:l}),"START"===a&&Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",children:"Create a server"}),Object(y.jsx)(ae.c,{}),Object(y.jsx)(ae.b,{pb:6,children:Object(y.jsxs)(Kn.e,{spacing:"5",children:[Object(y.jsx)(se.a,{textAlign:"center",children:"Your server is where you and your friends hang out. Make yours and start talking."}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},w:"full",onClick:function(){return s("CREATE")},children:"Create My Own"}),Object(y.jsx)(V.a,{}),Object(y.jsx)(se.a,{children:"Have an invite already?"}),Object(y.jsx)(N.a,{mt:"4",background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},w:"full",onClick:function(){return s("INVITE")},children:"Join a Server"})]})})]})]})}function et(e){var n=e.goBack,t=e.submitClose,r=Object(s.useQueryClient)(),c=Object(_.g)();function i(){return(i=Object(A.a)(R.a.mark((function e(n,i){var a,s,o,l,u,d,b;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.setErrors,""!==n.link){e.next=5;break}a({link:"Enter a valid link"}),e.next=17;break;case 5:return e.prev=5,e.next=8,Ye(n);case 8:s=e.sent,(o=s.data)&&(r.invalidateQueries(X),t(),c.push("/channels/".concat(o.id,"/").concat(o.default_channel_id))),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),u=null===e.t0||void 0===e.t0||null===(l=e.t0.response)||void 0===l?void 0:l.status,a(400===u||404===u?{link:null===e.t0||void 0===e.t0||null===(d=e.t0.response)||void 0===d||null===(b=d.data)||void 0===b?void 0:b.message}:ie(e.t0));case 17:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}return Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{link:""},onSubmit:function(e,n){return i.apply(this,arguments)},children:function(e){var t=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",pb:"0",children:"Join a Server"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{pb:3,children:[Object(y.jsx)(se.a,{fontSize:"14px",textColor:"brandGray.accent",children:"Enter an invite below to join an existing server"}),Object(y.jsx)(ye,{label:"invite link",name:"link"}),Object(y.jsx)(se.a,{mt:"4",fontSize:"12px",fontWeight:"semibold",textColor:"brandGray.accent",textTransform:"uppercase",children:"invite links should look like"}),Object(y.jsx)(se.a,{mt:"2",fontSize:"12px",textColor:"brandGray.accent",children:"drqgi2"}),Object(y.jsx)(se.a,{fontSize:"12px",textColor:"brandGray.accent",children:"https://discord.gg/drqgi2"})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{mr:6,variant:"link",onClick:n,fontSize:"14px",children:"Back"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:t,fontSize:"14px",children:"Join Server"})]})]})}})})}function nt(e){var n=e.goBack,t=e.submitClose,r=O((function(e){return e.current})),c=Object(s.useQueryClient)(),i=Object(_.g)();function a(){return(a=Object(A.a)(R.a.mark((function e(n,r){var a,s,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.setErrors,e.prev=1,e.next=4,He(n);case 4:s=e.sent,(o=s.data)&&c.setQueryData(X,(function(e){return[].concat(Object(Ne.a)(e),[o])})),t(),i.push("/channels/".concat(o.id,"/").concat(o.default_channel_id)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a(ie(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}return Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{name:"".concat(r.username,"'s server")},validationSchema:$n,onSubmit:function(e,n){return a.apply(this,arguments)},children:function(e){var t=e.isSubmitting,r=e.values;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",pb:"0",children:"Create your server"}),Object(y.jsx)(ae.c,{}),Object(y.jsx)(ae.b,{pb:3,children:Object(y.jsx)(ye,{label:"server name",name:"name",value:r.name})}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{mr:6,fontSize:"14px",variant:"link",onClick:n,children:"Back"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:t,fontSize:"14px",children:"Create"})]})]})}})})}var tt=t(114);function rt(e){var n=e.onOpen,t=Object(i.useState)(!1),r=Object(T.a)(t,2),c=r[0],a=r[1];return Object(y.jsxs)(y.Fragment,{children:[c&&Object(y.jsx)(Zn,{}),Object(y.jsx)(Fn,{label:"Add a Server",position:"right",children:Object(y.jsx)(E.a,{direction:"column",m:"auto",align:"center",justify:"center",bg:"brandGray.light",borderRadius:"50%",h:"48px",w:"48px",_hover:{cursor:"pointer",borderRadius:"35%",bg:"brandGreen",color:"white"},onClick:n,onMouseLeave:function(){return a(!1)},onMouseEnter:function(){return a(!0)},children:Object(y.jsx)(tt.c,{fontSize:"25px"})})})]})}function ct(e){var n=e.count;return Object(y.jsx)(E.a,{borderRadius:"50%",bg:"menuRed",position:"absolute",bottom:0,right:0,transform:"translate(25%, 25%)",border:"0.2em solid",borderColor:"brandBorder",w:"1.4em",h:"1.4em",justify:"center",align:"center",children:Object(y.jsx)(se.a,{fontSize:"11px",fontWeight:"bold",children:n})})}function it(e){var n=e.count;return Object(y.jsx)(E.a,{borderRadius:"50%",bg:"menuRed",w:"1.2em",h:"1.2em",justify:"center",align:"center",ml:2,children:Object(y.jsx)(se.a,{fontSize:"11px",fontWeight:"bold",children:n})})}function at(){var e="/channels/me"===Object(_.h)().pathname,n=Object(i.useState)(!1),t=Object(T.a)(n,2),r=t[0],c=t[1],a=v((function(e){return e.notifCount})),s=v((function(e){return e.reset}));return Object(i.useEffect)((function(){e&&s()})),Object(y.jsx)(Fn,{label:"Home",position:"right",children:Object(y.jsxs)(E.a,{direction:"column",my:"2",align:"center",children:[e&&Object(y.jsx)(Yn,{}),r&&Object(y.jsx)(Zn,{}),Object(y.jsx)(o.b,{to:"/channels/me",children:Object(y.jsxs)(E.a,{direction:"column",m:"auto",align:"center",justify:"center",bg:e?"highlight.standard":"brandGray.light",borderRadius:e?"35%":"50%",h:"48px",w:"48px",color:"white",position:"relative",_hover:{cursor:"pointer",borderRadius:"35%",bg:"highlight.standard"},onMouseLeave:function(){return c(!1)},onMouseEnter:function(){return c(!0)},children:[Object(y.jsx)(st,{}),a>0&&Object(y.jsx)(ct,{count:a})]})}),Object(y.jsx)(V.a,{mt:"2",w:"40px"})]})})}function st(){return Object(y.jsx)("img",{src:"/small-logo.png",style:{padding:"5px"},alt:"logo"})}function ot(){var e=Object(s.useQuery)(X,(function(){return U.get("/guilds").then((function(e){return e.data}))})).data,n=Object(D.a)(),t=n.isOpen,r=n.onOpen,c=n.onClose;return function(){var e=Object(_.g)(),n=Object(s.useQueryClient)(),t=O((function(e){return e.current})),r=Object(_.h)();Object(i.useEffect)((function(){var c=m();return c.emit("joinUser",null===t||void 0===t?void 0:t.id),c.on("edit_guild",(function(e){n.setQueryData(X,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e.id}));return-1!==t&&(n[t]=Object(xe.a)(Object(xe.a)({},n[t]),{},{name:e.name,icon:e.icon})),n}))})),c.on("delete_guild",(function(t){n.setQueryData(X,(function(n){return r.pathname.includes(t)&&e.replace("/channels/me"),null===n||void 0===n?void 0:n.filter((function(e){return e.id!==t}))}))})),c.on("remove_from_guild",(function(t){n.setQueryData(X,(function(n){return r.pathname.includes(t)&&e.replace("/channels/me"),n.filter((function(e){return e.id!==t}))}))})),c.on("new_notification",(function(e){r.pathname.includes(e)||n.setQueryData(X,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e}));return-1!==t&&(n[t]=Object(xe.a)(Object(xe.a)({},n[t]),{},{hasNotification:!0})),n}))})),function(){c.emit("leaveRoom",null===t||void 0===t?void 0:t.id),c.disconnect()}}),[t,n,e,r])}(),Object(y.jsxs)(Ee.b,{gridColumn:1,gridRow:"1 / 4",bg:"brandGray.darker",overflowY:"auto",css:An,zIndex:2,children:[Object(y.jsx)(at,{}),Object(y.jsx)(Bn.e,{listStyleType:"none",ml:"0",children:null===e||void 0===e?void 0:e.map((function(e){return Object(y.jsx)(Jn,{guild:e},e.id)}))}),Object(y.jsx)(rt,{onOpen:r}),t&&Object(y.jsx)(Xn,{isOpen:t,onClose:c}),Object(y.jsx)(M.a,{h:"20px"})]})}var lt=t(621),ut=t(343);function dt(e){var n=e.isOpen,t=e.onClose,r=O((function(e){return e.current})),c=Object(s.useQueryClient)(),i=Object(lt.a)((null===r||void 0===r?void 0:r.id)||""),a=i.hasCopied,o=i.onCopy;function l(){return(l=Object(A.a)(R.a.mark((function e(n,r){var i,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.setErrors,""!==n.id||20===n.id.length){e.next=5;break}i({id:"Enter a valid ID"}),e.next=16;break;case 5:return e.prev=5,e.next=8,Y(n.id);case 8:a=e.sent,a.data&&(t(),c.invalidateQueries(te)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),i(ie(e.t0));case 16:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}return Object(y.jsxs)(ae.a,{isOpen:n,onClose:t,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{id:""},onSubmit:function(e,n){return l.apply(this,arguments)},children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{fontWeight:"bold",pb:"0",children:"ADD FRIEND"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(se.a,{mb:"4",children:"You can add a friend with their UID."}),Object(y.jsxs)(Dn.a,{mb:2,children:[Object(y.jsx)(ut.b,{bg:"#202225",borderColor:"black",children:"UID"}),Object(y.jsx)(ge.a,{bg:"brandGray.dark",borderColor:a?"brandGreen":"black",borderRadius:"3px",focusBorderColor:"highlight.standard",value:(null===r||void 0===r?void 0:r.id)||"",isReadOnly:!0}),Object(y.jsx)(Ln.b,{width:"4.5rem",children:Object(y.jsx)(N.a,{h:"1.75rem",size:"sm",bg:a?"brandGreen":"highlight.standard",color:"white",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},onClick:o,children:a?"Copied":"Copy"})})]}),Object(y.jsx)(ye,{label:"Enter a user ID",name:"id"})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",mt:"2",children:[Object(y.jsx)(N.a,{mr:6,variant:"link",onClick:t,fontSize:"14px",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:n,fontSize:"14px",children:"Send Friend Request"})]})]})}})})]})}function bt(){var e=Object(D.a)(),n=e.isOpen,t=e.onOpen,r=e.onClose,c=v((function(e){return e.toggleDisplay})),i=v((function(e){return e.isPending})),a=v((function(e){return e.requestCount}));return Object(y.jsxs)(Ee.b,{gridColumn:3,gridRow:"1",bg:"brandGray.light",padding:"10px",zIndex:"2",boxShadow:"md",children:[Object(y.jsxs)(E.a,{align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",ml:2,fontSize:"14px",children:[Object(y.jsx)(Ve.a,{as:vn.c,fontSize:"20px"}),Object(y.jsx)(se.a,{ml:"2",fontWeight:"semibold",children:"Friends"}),Object(y.jsx)(N.a,{fontSize:"14px",ml:"4",size:"xs",colorScheme:"gray",onClick:function(){i&&c()},variant:i?"ghost":"solid",children:"Friends"}),Object(y.jsxs)(N.a,{fontSize:"14px",size:"xs",ml:"2",colorScheme:"gray",variant:i?"solid":"ghost",onClick:function(){i||c()},children:["Pending",a>0&&Object(y.jsx)(ct,{count:a})]})]}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{fontSize:"14px",size:"xs",bg:"brandGreen",_hover:{bg:"brandGreen"},_active:{bg:"brandGreen"},onClick:t,children:"Add Friend"})})]}),n&&Object(y.jsx)(dt,{isOpen:n,onClose:r})]})}var jt=t(344);function ht(e){var n=e.friend,t=Object(D.a)(),r=t.isOpen,c=t.onOpen,i=t.onClose,a=Object(_.g)(),o=Object(s.useQueryClient)();function l(){return(l=Object(A.a)(R.a.mark((function e(){var t,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be(n.id);case 2:t=e.sent,(r=t.data)&&(o.invalidateQueries(ee),a.push("/channels/me/".concat(r.id)));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(Bn.c,{p:"3",mx:"3",_hover:{bg:"brandGray.dark",borderRadius:"5px"},children:[Object(y.jsxs)(E.a,{align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",w:"full",onClick:function(){return l.apply(this,arguments)},_hover:{cursor:"pointer"},children:[Object(y.jsx)(F.a,{size:"sm",src:n.image,children:Object(y.jsx)(F.b,{boxSize:"1.25em",bg:n.isOnline?"green.500":"gray.500"})}),Object(y.jsx)(se.a,{ml:"2",children:n.username})]}),Object(y.jsx)(jt.a,{icon:Object(y.jsx)(mn.c,{}),borderRadius:"50%","aria-label":"remove friend",onClick:function(e){e.preventDefault(),c()}})]}),r&&Object(y.jsx)(an,{id:n.id,isOpen:!0,onClose:i})]})}function xt(e){var n=e.label;return Object(y.jsx)(se.a,{fontSize:"12px",color:"brandGray.accent",textTransform:"uppercase",fontWeight:"semibold",mx:"4",mt:"4",mb:"1",w:"50%",children:n})}function ft(){var e=Object(s.useQuery)(ne,(function(){return U.get("/account/me/friends").then((function(e){return e.data}))})).data;return function(){var e=O((function(e){return e.current})),n=v((function(e){return e.setRequests})),t=Object(s.useQueryClient)();Object(i.useEffect)((function(){var r=m();return r.emit("joinUser",null===e||void 0===e?void 0:e.id),r.emit("getRequestCount"),r.on("add_friend",(function(e){t.setQueryData(ne,(function(n){return[].concat(Object(Ne.a)(n),[e]).sort((function(e,n){return e.username.localeCompare(n.username)}))}))})),r.on("remove_friend",(function(e){t.setQueryData(ne,(function(n){return Object(Ne.a)(null===n||void 0===n?void 0:n.filter((function(n){return n.id!==e})))}))})),r.on("toggle_online",(function(e){t.setQueryData(ne,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e}));return-1!==t&&(n[t].isOnline=!0),n}))})),r.on("toggle_offline",(function(e){t.setQueryData(ne,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e}));return-1!==t&&(n[t].isOnline=!1),n}))})),r.on("requestCount",(function(e){n(e)})),function(){r.emit("leaveRoom",null===e||void 0===e?void 0:e.id),r.disconnect()}}),[t,e,n])}(),0===(null===e||void 0===e?void 0:e.length)?Object(y.jsx)(E.a,{justify:"center",align:"center",w:"full",children:Object(y.jsx)(se.a,{textColor:"brandGray.accent",children:"No one here yet"})}):Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(Bn.e,{listStyleType:"none",ml:"0",w:"full",mt:"2",children:[Object(y.jsx)(xt,{label:"friends \u2014 ".concat((null===e||void 0===e?void 0:e.length)||0)}),null===e||void 0===e?void 0:e.map((function(e){return Object(y.jsx)(ht,{friend:e},e.id)}))]})})}var Ot=t(217);function pt(e){var n=e.request,t=Object(s.useQueryClient)(),r=function(){var e=Object(A.a)(R.a.mark((function e(){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c=n.id,U.post("/account/".concat(c,"/friend/accept"));case 2:if(r=e.sent,!r.data){e.next=8;break}return t.setQueryData(te,(function(e){return null===e||void 0===e?void 0:e.filter((function(e){return e.id!==n.id}))})),e.next=8,t.invalidateQueries(ne);case 8:case"end":return e.stop()}var c}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(A.a)(R.a.mark((function e(){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c=n.id,U.post("/account/".concat(c,"/friend/cancel"));case 2:r=e.sent,r.data&&t.setQueryData(te,(function(e){return null===e||void 0===e?void 0:e.filter((function(e){return e.id!==n.id}))}));case 5:case"end":return e.stop()}var c}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)(Bn.c,{p:"3",mx:"3",_hover:{bg:"brandGray.dark",borderRadius:"5px"},children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(F.a,{size:"sm",src:n.image}),Object(y.jsxs)(M.a,{ml:"2",children:[Object(y.jsx)(se.a,{children:n.username}),Object(y.jsx)(se.a,{fontSize:"12px",children:1===n.type?"Incoming Friend Request":"Outgoing Friend Request"})]})]}),Object(y.jsxs)(E.a,{align:"center",children:[1===n.type&&Object(y.jsx)(Fn,{label:"Accept",position:"top",children:Object(y.jsx)(jt.a,{icon:Object(y.jsx)(Ot.a,{}),borderRadius:"50%","aria-label":"accept request",fontSize:"28px",onClick:r,mr:"2"})}),Object(y.jsx)(Fn,{label:"Decline",position:"top",children:Object(y.jsx)(jt.a,{icon:Object(y.jsx)(tt.a,{}),borderRadius:"50%","aria-label":"decline request",fontSize:"20px",onClick:c})})]})]})})}function gt(){var e=Object(s.useQuery)(te,(function(){return U.get("/account/me/pending").then((function(e){return e.data}))})).data,n=v((function(e){return e.resetRequest}));return Object(i.useEffect)((function(){n()})),0===(null===e||void 0===e?void 0:e.length)?Object(y.jsx)(E.a,{justify:"center",align:"center",w:"full",children:Object(y.jsx)(se.a,{textColor:"brandGray.accent",children:"There are no pending friend requests"})}):Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(Bn.e,{listStyleType:"none",ml:"0",w:"full",mt:"2",children:[Object(y.jsx)(xt,{label:"Pending \u2014 ".concat((null===e||void 0===e?void 0:e.length)||0)}),null===e||void 0===e?void 0:e.map((function(e){return Object(y.jsx)(pt,{request:e},e.id)}))]})})}function mt(){var e=v((function(e){return e.isPending}));return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(bt,{}),Object(y.jsx)(Ee.b,{gridColumn:3,gridRow:"2",bg:"brandGray.light",mr:"5px",display:"flex",overflowY:"auto",css:j,children:e?Object(y.jsx)(gt,{}):Object(y.jsx)(ft,{})})]})}function vt(){var e=In(Object(_.i)().channelId);return Object(y.jsx)(Ee.b,{gridColumn:3,gridRow:"1",bg:"brandGray.light",padding:"10px",zIndex:"2",boxShadow:"md",children:Object(y.jsxs)(E.a,{align:"center",ml:2,children:[Object(y.jsx)(Ve.a,{as:mn.a,fontSize:"20px",color:"brandGray.accent"}),Object(y.jsx)(se.a,{ml:"2",fontWeight:"semibold",children:null===e||void 0===e?void 0:e.user.username}),Object(y.jsx)(M.a,{ml:"2",borderRadius:"50%",h:"10px",w:"10px",bg:(null===e||void 0===e?void 0:e.user.isOnline)?"green.500":"gray.500"})]})})}var yt=t(368);function wt(e){var n=e.dm,t="/channels/me/".concat(n.id),r=Object(_.h)().pathname===t,c=Object(i.useState)(!1),a=Object(T.a)(c,2),l=a[0],u=a[1],d=Object(s.useQueryClient)(),b=Object(_.g)();function j(){return(j=Object(A.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,Ue(n.id);case 3:d.setQueryData(ee,(function(e){return null===e||void 0===e?void 0:e.filter((function(e){return e.id!==n.id}))})),r&&b.replace("/channels/me");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsx)(o.b,{to:"/channels/me/".concat(n.id),children:Object(y.jsx)(Bn.c,{p:"2",mx:"2",color:r?"#fff":"brandGray.accent",_hover:{bg:"brandGray.light",borderRadius:"5px",cursor:"pointer",color:"#fff"},bg:r?"brandGray.active":void 0,onMouseLeave:function(){return u(!1)},onMouseEnter:function(){return u(!0)},children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(F.a,{size:"sm",src:n.user.image,children:Object(y.jsx)(F.b,{boxSize:"1.25em",bg:n.user.isOnline?"green.500":"gray.500"})}),Object(y.jsx)(se.a,{ml:"2",children:n.user.username})]}),l&&Object(y.jsx)(Ve.a,{as:yt.a,onClick:function(e){return j.apply(this,arguments)}})]})})})}function Ct(){return Object(y.jsxs)(E.a,{align:"center",m:"3",children:[Object(y.jsx)(M.a,{w:"32px",h:"32px",borderRadius:"50%",bg:"brandGray.light"}),Object(y.jsx)(M.a,{ml:2,height:"20px",w:"144px",bg:"brandGray.light",borderRadius:"10px"})]})}function kt(){var e="/channels/me"===Object(_.h)().pathname,n=v((function(e){return e.requestCount}));return Object(y.jsx)(o.b,{to:"/channels/me",children:Object(y.jsxs)(E.a,{m:"2",p:"3",align:"center",justify:"space-between",color:e?"#fff":"brandGray.accent",_hover:{bg:"brandGray.light",borderRadius:"5px",cursor:"pointer",color:"#fff"},bg:e?"brandGray.active":void 0,children:[Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(Ve.a,{as:vn.c,fontSize:"20px"}),Object(y.jsx)(se.a,{fontSize:"14px",ml:"4",fontWeight:"semibold",children:"Friends"})]}),n>0&&Object(y.jsx)(it,{count:n})]})})}var St=t(218);function It(){var e=O((function(e){return e.current})),n=Object(lt.a)((null===e||void 0===e?void 0:e.id)||""),t=n.hasCopied,r=n.onCopy;return Object(y.jsxs)(E.a,{p:"10px",pos:"absolute",bottom:"0",w:"240px",bg:"accountBar",align:"center",justify:"space-between",children:[Object(y.jsx)(P.a,{hasArrow:!0,label:t?"Copied!":"Click to copy ID",placement:"top",bg:t?"brandGreen":"brandGray.darkest",color:"white",closeOnClick:!1,children:Object(y.jsxs)(E.a,{align:"center",w:"full",mr:2,_hover:{cursor:"pointer"},onClick:r,children:[Object(y.jsx)(F.a,{size:"sm",src:null===e||void 0===e?void 0:e.image}),Object(y.jsx)(se.a,{ml:"2",children:null===e||void 0===e?void 0:e.username})]})}),Object(y.jsx)(o.b,{to:"/account",children:Object(y.jsx)(P.a,{hasArrow:!0,label:"User Settings",placement:"top",bg:"brandGray.darkest",color:"white",children:Object(y.jsx)(jt.a,{icon:Object(y.jsx)(St.a,{}),"aria-label":"settings",size:"sm",fontSize:"20px",variant:"ghost"})})})]})}var zt={"&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{width:"4px"},"&::-webkit-scrollbar-thumb":{background:"brandGray.darker",borderRadius:"18px"}};function _t(){var e=Object(s.useQuery)(ee,(function(){return U.get("/channels/me/dm").then((function(e){return e.data}))})).data;return function(){var e=O((function(e){return e.current})),n=Object(s.useQueryClient)();Object(i.useEffect)((function(){var t=m();return t.emit("joinUser",null===e||void 0===e?void 0:e.id),t.on("push_to_top",(function(e){n.setQueryData(ee,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e}));return 0===t||-1===t?Object(Ne.a)(n):[n[t]].concat(Object(Ne.a)(n.filter((function(n){return n.id!==e}))))}))})),function(){t.emit("leaveRoom",null===e||void 0===e?void 0:e.id),t.disconnect()}}),[e,n])}(),Object(y.jsxs)(Ee.b,{gridColumn:"2",gridRow:"1 / 4",bg:"brandGray.dark",overflowY:"hidden",_hover:{overflowY:"auto"},css:zt,children:[Object(y.jsx)(kt,{}),Object(y.jsx)(se.a,{ml:"4",textTransform:"uppercase",fontSize:"12px",fontWeight:"semibold",color:"brandGray.accent",children:"DIRECT MESSAGES"}),Object(y.jsxs)(Bn.e,{listStyleType:"none",ml:"0",mt:"4",children:[null===e||void 0===e?void 0:e.map((function(e){return Object(y.jsx)(wt,{dm:e},e.id)})),0===(null===e||void 0===e?void 0:e.length)&&Object(y.jsxs)(M.a,{children:[Object(y.jsx)(Ct,{}),Object(y.jsx)(Ct,{}),Object(y.jsx)(Ct,{}),Object(y.jsx)(Ct,{}),Object(y.jsx)(Ct,{})]})]}),Object(y.jsx)(It,{})]})}function Gt(){var e=Object(_.i)().channelId;return Object(y.jsxs)(Me,{children:[Object(y.jsx)(ot,{}),Object(y.jsx)(_t,{}),void 0===e?Object(y.jsx)(mt,{}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(vt,{}),Object(y.jsx)(Qn,{}),Object(y.jsx)(Vn,{})]})]})}var Rt=t(345);function At(){var e=Object(i.useState)(null),n=Object(T.a)(e,2),t=n[0],r=n[1],c=Object(_.i)().link,a=Object(s.useQueryClient)(),l=Object(_.g)();return Object(i.useEffect)((function(){function e(){return(e=Object(A.a)(R.a.mark((function e(){var n,t,i,s,o,u;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye({link:c});case 3:n=e.sent,(t=n.data)&&(a.invalidateQueries(X),l.push("/channels/".concat(t.id,"/").concat(t.default_channel_id))),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),s=null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i?void 0:i.status,r(400===s||404===s?{link:null===e.t0||void 0===e.t0||null===(o=e.t0.response)||void 0===o||null===(u=o.data)||void 0===u?void 0:u.message}:"An error occured. Please try again later.");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[c,l,a]),Object(y.jsx)(E.a,{minHeight:"100vh",align:"center",justify:"center",h:"full",children:Object(y.jsxs)(M.a,{textAlign:"center",children:[Object(y.jsx)(E.a,{mb:"4",justify:"center",children:Object(y.jsx)(Qe.a,{src:"/logo.png",w:"80px"})}),Object(y.jsx)(se.a,{children:"Fetching server info. Please wait."}),Object(y.jsx)(se.a,{children:"You will be automatically redirected."}),t&&Object(y.jsxs)(M.a,{children:[Object(y.jsx)(se.a,{my:"2",textColor:"menuRed",children:t}),Object(y.jsxs)(se.a,{children:["Click"," ",Object(y.jsx)(Rt.a,{as:o.b,to:"/channels/me",color:"highlight.standard",children:"here"})," ","to return."]})]})]})})}function Tt(){return Object(y.jsx)(E.a,{bottom:0,as:"footer",align:"center",justify:"center",w:"100%",p:8,children:Object(y.jsx)(M.a,{textAlign:"center",children:Object(y.jsx)(se.a,{fontSize:"xl",children:Object(y.jsx)("span",{children:"Discord | 2021"})})})})}function Qt(){return Object(y.jsx)("svg",{width:"124",height:"34",viewBox:"0 0 124 34",className:"logo-3LF899",children:Object(y.jsxs)("g",{fill:"currentColor",children:[Object(y.jsx)("path",{d:"M18.1558 14.297C17.1868 14.297 16.4218 15.13 16.4218 16.167C16.4218 17.204 17.2038 18.037 18.1558 18.037C19.1248 18.037 19.8898 17.204 19.8898 16.167C19.8898 15.13 19.1078 14.297 18.1558 14.297ZM11.9508 14.297C10.9818 14.297 10.2168 15.13 10.2168 16.167C10.2168 17.204 10.9988 18.037 11.9508 18.037C12.9198 18.037 13.6848 17.204 13.6848 16.167C13.7018 15.13 12.9198 14.297 11.9508 14.297Z"}),Object(y.jsx)("path",{d:"M26.4178 0.152954H3.63783C1.71683 0.152954 0.152832 1.71695 0.152832 3.63795V26.418C0.152832 28.339 1.71683 29.903 3.63783 29.903H22.9158L22.0148 26.792L24.1908 28.798L26.2478 30.685L29.9198 33.864V3.63795C29.9028 1.71695 28.3388 0.152954 26.4178 0.152954ZM19.8558 22.168C19.8558 22.168 19.2438 21.437 18.7338 20.808C20.9608 20.179 21.8108 18.802 21.8108 18.802C21.1138 19.261 20.4508 19.584 19.8558 19.805C19.0058 20.162 18.1898 20.383 17.3908 20.536C15.7588 20.842 14.2628 20.757 12.9878 20.519C12.0188 20.332 11.1858 20.077 10.4888 19.788C10.0978 19.635 9.67283 19.448 9.24783 19.21C9.19683 19.176 9.14583 19.159 9.09483 19.125C9.06083 19.108 9.04383 19.091 9.02683 19.091C8.72083 18.921 8.55083 18.802 8.55083 18.802C8.55083 18.802 9.36683 20.145 11.5258 20.791C11.0158 21.437 10.3868 22.185 10.3868 22.185C6.62983 22.066 5.20183 19.618 5.20183 19.618C5.20183 14.195 7.64983 9.79195 7.64983 9.79195C10.0978 7.97295 12.4098 8.02395 12.4098 8.02395L12.5798 8.22795C9.51983 9.09495 8.12583 10.438 8.12583 10.438C8.12583 10.438 8.49983 10.234 9.12883 9.96195C10.9478 9.16295 12.3928 8.95895 12.9878 8.89095C13.0898 8.87395 13.1748 8.85695 13.2768 8.85695C14.3138 8.72095 15.4868 8.68695 16.7108 8.82295C18.3258 9.00995 20.0598 9.48595 21.8278 10.438C21.8278 10.438 20.4848 9.16295 17.5948 8.29595L17.8328 8.02395C17.8328 8.02395 20.1618 7.97295 22.5928 9.79195C22.5928 9.79195 25.0408 14.195 25.0408 19.618C25.0408 19.601 23.6128 22.049 19.8558 22.168ZM45.5258 7.42895H39.8818V13.77L43.6388 17.153V10.999H45.6448C46.9198 10.999 47.5488 11.611 47.5488 12.597V17.306C47.5488 18.292 46.9538 18.955 45.6448 18.955H39.8648V22.542H45.5088C48.5348 22.559 51.3738 21.046 51.3738 17.578V12.512C51.3908 8.97595 48.5518 7.42895 45.5258 7.42895ZM75.1058 17.578V12.376C75.1058 10.506 78.4718 10.081 79.4918 11.951L82.6028 10.693C81.3788 8.00695 79.1518 7.22495 77.2988 7.22495C74.2728 7.22495 71.2808 8.97595 71.2808 12.376V17.578C71.2808 21.012 74.2728 22.729 77.2308 22.729C79.1348 22.729 81.4128 21.794 82.6708 19.346L79.3388 17.816C78.5228 19.907 75.1058 19.397 75.1058 17.578ZM64.8208 13.09C63.6478 12.835 62.8658 12.41 62.8148 11.679C62.8828 9.92795 65.5858 9.85995 67.1668 11.543L69.6658 9.62195C68.1018 7.71795 66.3338 7.20795 64.5148 7.20795C61.7438 7.20795 59.0578 8.77195 59.0578 11.73C59.0578 14.603 61.2678 16.15 63.6988 16.524C64.9398 16.694 66.3168 17.187 66.2828 18.037C66.1808 19.652 62.8488 19.567 61.3358 17.731L58.9218 19.992C60.3328 21.811 62.2538 22.729 64.0558 22.729C66.8268 22.729 69.9038 21.131 70.0228 18.207C70.1928 14.518 67.5068 13.583 64.8208 13.09ZM53.4308 22.525H57.2388V7.42895H53.4308V22.525ZM117.64 7.42895H111.996V13.77L115.753 17.153V10.999H117.759C119.034 10.999 119.663 11.611 119.663 12.597V17.306C119.663 18.292 119.068 18.955 117.759 18.955H111.979V22.542H117.64C120.666 22.559 123.505 21.046 123.505 17.578V12.512C123.505 8.97595 120.666 7.42895 117.64 7.42895ZM89.9468 7.22495C86.8188 7.22495 83.7078 8.92495 83.7078 12.41V17.561C83.7078 21.012 86.8358 22.746 89.9808 22.746C93.1088 22.746 96.2198 21.012 96.2198 17.561V12.41C96.2198 8.94195 93.0748 7.22495 89.9468 7.22495ZM92.3948 17.561C92.3948 18.649 91.1708 19.21 89.9638 19.21C88.7398 19.21 87.5158 18.683 87.5158 17.561V12.41C87.5158 11.305 88.7058 10.71 89.8958 10.71C91.1368 10.71 92.3948 11.237 92.3948 12.41V17.561ZM109.888 12.41C109.803 8.87395 107.389 7.44595 104.278 7.44595H98.2428V22.542H102.102V17.748H102.782L106.284 22.542H111.044L106.93 17.357C108.749 16.779 109.888 15.198 109.888 12.41ZM104.346 14.45H102.102V10.999H104.346C106.743 10.999 106.743 14.45 104.346 14.45Z"})]})})}function Dt(){var e=O((function(e){return e.current}));return Object(y.jsxs)(E.a,{as:"nav",align:"center",justify:"space-between",wrap:"wrap",w:"100%",mb:8,p:8,children:[Object(y.jsx)(E.a,{align:"center",children:Object(y.jsx)(Qt,{})}),Object(y.jsx)(E.a,{align:"center",justify:"flex-end",children:e?Object(y.jsx)(o.b,{to:"/channels/me",children:Object(y.jsx)(N.a,{_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},size:"md",rounded:"md",variant:"outline",children:"Open App"})}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(o.b,{to:"/login",children:Object(y.jsx)(N.a,{color:"white",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},size:"md",rounded:"md",variant:"outline",mx:"4",children:"Login"})}),Object(y.jsx)(o.b,{to:"/register",children:Object(y.jsx)(N.a,{_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},size:"md",rounded:"md",variant:"outline",children:"Register"})})]})})]})}function Et(e){var n=e.children;return Object(y.jsxs)(E.a,{direction:"column",align:"center",maxW:{xl:"1200px"},m:"0 auto",children:[Object(y.jsx)(Dt,{}),n,Object(y.jsx)(Tt,{})]})}var Mt=["title","subtitle","image","ctaLink","ctaText"];function Lt(e){var n=e.title,t=e.subtitle,r=e.image,c=e.ctaLink,i=e.ctaText,a=Object(fe.a)(e,Mt);return Object(y.jsxs)(E.a,Object(xe.a)(Object(xe.a)({align:"center",justify:{base:"center",md:"space-around",xl:"space-between"},direction:{base:"column-reverse",md:"row"},wrap:"nowrap",minH:"70vh",px:8,mb:16},a),{},{children:[Object(y.jsxs)(Kn.b,{spacing:4,w:{base:"80%",md:"40%"},align:["center","center","flex-start","flex-start"],children:[Object(y.jsx)(L.a,{as:"h1",size:"xl",fontWeight:"bold",textAlign:["center","center","left","left"],children:n}),Object(y.jsx)(L.a,{as:"h2",size:"md",opacity:"0.8",fontWeight:"normal",lineHeight:1.5,textAlign:["center","center","left","left"],children:t}),Object(y.jsx)(o.b,{to:c,children:Object(y.jsx)(N.a,{colorScheme:"blue",borderRadius:"8px",py:"4",px:"4",lineHeight:"1",size:"md",children:i})}),Object(y.jsxs)(se.a,{fontSize:"xs",mt:2,textAlign:"center",opacity:"0.6",children:["Got an account already?"," ",Object(y.jsx)(Rt.a,{as:o.b,to:"/login",children:"Sign in"})]})]}),Object(y.jsx)(M.a,{w:{base:"80%",sm:"60%",md:"50%"},mb:{base:12,md:0},children:Object(y.jsx)(Qe.a,{src:r,size:"50%",rounded:"1rem"})})]}))}function Pt(){return Object(y.jsx)(Et,{children:Object(y.jsx)(Lt,{title:"An invite-only place with plenty of room to talk",subtitle:"Discord servers are organized into topic-based channels where you can collaborate, share, and just talk about your day without clogging up a group chat.",image:"/landing.svg",ctaText:"Get Started",ctaLink:"/register"})})}function Ft(){var e=Object(_.g)(),n=O((function(e){return e.setUser})),t=function(){var t=Object(A.a)(R.a.mark((function t(r,c){var i,a,s,o,l;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.setErrors,t.prev=1,t.next=4,u=r,U.post("/account/login",u);case 4:a=t.sent,(s=a.data)&&(n(s),e.push("/channels/me")),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),401===(null===t.t0||void 0===t.t0||null===(o=t.t0.response)||void 0===o?void 0:o.status)?i({password:"Invalid credentials"}):404===(null===t.t0||void 0===t.t0||null===(l=t.t0.response)||void 0===l?void 0:l.status)&&i({email:"No user found"});case 12:case"end":return t.stop()}var u}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}();return Object(y.jsx)(E.a,{minHeight:"100vh",width:"full",align:"center",justifyContent:"center",children:Object(y.jsxs)(M.a,{px:4,width:"full",maxWidth:"500px",textAlign:"center",children:[Object(y.jsx)(E.a,{mb:"4",justify:"center",children:Object(y.jsx)(Qe.a,{src:"/discord-logo.png",w:"80px"})}),Object(y.jsxs)(M.a,{p:4,borderRadius:4,background:"brandGray.light",children:[Object(y.jsx)(M.a,{textAlign:"center",children:Object(y.jsx)(L.a,{fontSize:"24px",children:"Welcome Back"})}),Object(y.jsx)(M.a,{my:4,textAlign:"left",children:Object(y.jsx)($.b,{initialValues:{email:"",password:""},validationSchema:le,onSubmit:t,children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ye,{label:"Email",name:"email",autoComplete:"email",type:"email"}),Object(y.jsx)(ye,{label:"password",name:"password",autoComplete:"password",type:"password"}),Object(y.jsx)(M.a,{mt:4,children:Object(y.jsx)(Rt.a,{as:o.b,to:"/forgot-password",textColor:"highlight.standard",children:"Forgot Password?"})}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",width:"full",mt:4,type:"submit",isLoading:n,_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},children:"Login"}),Object(y.jsxs)(se.a,{mt:"4",children:["Don't have an account yet?"," ",Object(y.jsx)(Rt.a,{as:o.b,to:"/register",textColor:"highlight.standard",children:"Sign Up"})]})]})}})})]})]})})}function qt(){var e=Object(_.g)(),n=O((function(e){return e.setUser})),t=function(){var t=Object(A.a)(R.a.mark((function t(r,c){var i,a,s;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.setErrors,t.prev=1,t.next=4,o=r,U.post("/account/register",o);case 4:a=t.sent,(s=a.data)&&(n(s),e.push("/channels/me")),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0,ie(t.t0)),i(ie(t.t0));case 13:case"end":return t.stop()}var o}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}();return Object(y.jsx)(E.a,{minHeight:"100vh",width:"full",align:"center",justifyContent:"center",children:Object(y.jsxs)(M.a,{px:4,width:"full",maxWidth:"500px",textAlign:"center",children:[Object(y.jsx)(E.a,{mb:"4",justify:"center",children:Object(y.jsx)(Qe.a,{src:"/logo.png",w:"80px"})}),Object(y.jsxs)(M.a,{p:4,borderRadius:4,background:"brandGray.light",children:[Object(y.jsx)(M.a,{textAlign:"center",children:Object(y.jsx)(L.a,{fontSize:"24px",children:"Welcome to Discord"})}),Object(y.jsx)(M.a,{my:4,textAlign:"left",children:Object(y.jsx)($.b,{initialValues:{email:"",username:"",password:""},validationSchema:ue,onSubmit:t,children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ye,{label:"Email",name:"email",autoComplete:"email",type:"email"}),Object(y.jsx)(ye,{label:"username",name:"username"}),Object(y.jsx)(ye,{label:"password",name:"password",autoComplete:"password",type:"password"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",width:"full",mt:4,type:"submit",isLoading:n,_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},children:"Register"}),Object(y.jsxs)(se.a,{mt:"4",children:["Already have an account?"," ",Object(y.jsx)(Rt.a,{as:o.b,to:"/login",textColor:"highlight.standard",children:"Sign In"})]})]})}})})]})]})})}function Nt(){var e=Object(_.g)(),n=Object(_.i)().token,t=Object(i.useState)(""),r=Object(T.a)(t,2),c=r[0],a=r[1],s=O((function(e){return e.setUser}));function l(){return(l=Object(A.a)(R.a.mark((function t(r,c){var i,o,l,u;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.setErrors,t.prev=1,t.next=4,K(Object(xe.a)(Object(xe.a)({},r),{},{token:n}));case 4:o=t.sent,(l=o.data)&&(s(l),e.push("/channels/me")),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),"token"in(u=ie(t.t0))&&a(u.token),i(u);case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))).apply(this,arguments)}return Object(y.jsx)(E.a,{minHeight:"100vh",width:"full",align:"center",justifyContent:"center",children:Object(y.jsxs)(M.a,{px:4,width:"full",maxWidth:"500px",textAlign:"center",children:[Object(y.jsx)(E.a,{mb:"4",justify:"center",children:Object(y.jsx)(Qe.a,{src:"/logo.png",w:"80px"})}),Object(y.jsxs)(M.a,{p:4,borderRadius:4,background:"brandGray.light",children:[Object(y.jsx)(M.a,{textAlign:"center",children:Object(y.jsx)(L.a,{fontSize:"24px",children:"Reset Password"})}),Object(y.jsxs)(M.a,{my:4,textAlign:"left",children:[Object(y.jsx)($.b,{initialValues:{newPassword:"",confirmNewPassword:""},validationSchema:be,onSubmit:function(e,n){return l.apply(this,arguments)},children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ye,{label:"New Password",name:"newPassword",autoComplete:"new-password",type:"password"}),Object(y.jsx)(ye,{label:"Confirm New Password",name:"confirmNewPassword",type:"password"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",width:"full",mt:4,type:"submit",isLoading:n,_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},children:"Reset Password"})]})}}),c?Object(y.jsxs)(E.a,{direction:"column",mt:"4",justify:"center",align:"center",children:[Object(y.jsx)(se.a,{children:"Invalid or expired token."}),Object(y.jsx)(Rt.a,{as:o.b,to:"/forgot-password",color:"red",children:"Click here to get a new token"})]}):null]})]})]})})}var Wt=x()(Object(f.persist)((function(e,n){return{showMembers:!0,toggleShowMembers:function(){return e({showMembers:!n().showMembers})}}}),{name:"settings-storage"})),Vt=t(369);function Bt(){var e=Wt((function(e){return e.toggleShowMembers})),n=Object(_.i)(),t=n.guildId,r=Sn(n.channelId,re(t));return Object(y.jsx)(Ee.b,{gridColumn:3,gridRow:"1",bg:"brandGray.light",padding:"10px",zIndex:"2",boxShadow:"md",children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(mn.d,{}),Object(y.jsx)(se.a,{ml:"2",fontWeight:"semibold",children:null===r||void 0===r?void 0:r.name})]}),Object(y.jsx)(Ve.a,{as:Vt.a,fontSize:"20px",mr:"2",_hover:{cursor:"pointer"},onClick:e})]})})}var Ut=function(e,n){return U.post("/channels/".concat(e),n)},Ht=function(e,n,t){return U.put("/channels/".concat(e,"/").concat(n),t)},Yt=function(e,n){return U.delete("/channels/".concat(e,"/").concat(n))};var Zt=t(622),Jt=t(219),Kt=oe.d().shape({name:oe.f().min(3).max(30).required("This field is required"),isPublic:oe.b().optional().default(!0),members:oe.a(oe.f().optional().max(20,"Must provide memberIds")).optional()});function $t(e){var n=e.guildId,t=e.channelId,r=e.isOpen,c=e.onClose,a=ce(n),o=Object(s.useQuery)(a,(function(){return Ke(n).then((function(e){return e.data}))})).data,l=Sn(t,re(n)),u=[],d=Object(i.useState)([]),b=Object(T.a)(d,2),j=b[0],h=b[1],x=Object(i.useState)("START"),f=Object(T.a)(x,2),O=f[0],p=f[1];function g(){return(g=Object(A.a)(R.a.mark((function e(r,i){var a,s,o,l;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.setErrors,s=i.resetForm,e.prev=1,o=[],j.map((function(e){return o.push(e.value)})),e.next=6,Ht(n,t,Object(xe.a)(Object(xe.a)({},r),{},{members:o}));case 6:l=e.sent,l.data&&(s(),c()),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a(ie(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}null===o||void 0===o||o.map((function(e){return u.push({label:e.username,value:e.id,image:e.image})}));var m=Object(s.useQuery)("".concat(t,"-members"),Object(A.a)(R.a.mark((function e(){var n,t,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null;case 2:return n=e.sent,t=n.data,r=u.filter((function(e){return t.includes(e.value)})),h(r),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))),v=(m.data,function(e){h((function(n){return[].concat(Object(Ne.a)(n),[e])}))}),w=function(e){return Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(F.a,{mr:2,size:"sm",src:e.image}),Object(y.jsx)(se.a,{textColor:"#000",children:e.label})]})};return l?Object(y.jsxs)(ae.a,{isOpen:r,onClose:c,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),"START"===O&&Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{name:l.name,isPublic:l.isPublic},validationSchema:Kt,onSubmit:function(e,n){return g.apply(this,arguments)},children:function(e){var n=e.isSubmitting,t=e.setFieldValue,r=e.values;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",children:"Channel Settings"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(ye,{label:"channel name",name:"name"}),Object(y.jsxs)(Oe.a,{display:"flex",alignItems:"center",justifyContent:"space-between",mt:"4",children:[Object(y.jsx)(pe.a,{mb:"0",children:Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(tt.b,{}),Object(y.jsx)(se.a,{ml:"2",children:"Private Channel"})]})}),Object(y.jsx)(Zt.a,{defaultChecked:!r.isPublic,onChange:function(e){t("isPublic",!e.target.checked)}})]}),Object(y.jsx)(se.a,{mt:"4",fontSize:"14px",textColor:"brandGray.accent",children:"By making a channel private, only selected members will be able to view this channel"}),!r.isPublic&&Object(y.jsx)(M.a,{mt:"2",pb:0,children:Object(y.jsx)(Jt.CUIAutoComplete,{label:"Who can access this channel",placeholder:"",onCreateItem:v,items:u,selectedItems:j,itemRenderer:w,onSelectedItemsChange:function(e){return function(e){e&&h(e)}(e.selectedItems)}})}),Object(y.jsx)(V.a,{my:"2"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{onClick:function(){return p("CONFIRM")},colorScheme:"red",variant:"ghost",fontSize:"14px",rightIcon:Object(y.jsx)(mn.e,{}),children:"Delete Channel"})})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:c,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:n,fontSize:"14px",children:"Save Changes"})]})]})}})}),"CONFIRM"===O&&Object(y.jsx)(Xt,{goBack:function(){return p("START")},submitClose:function(){p("START"),c()},name:l.name,channelId:l.id,guildId:n})]}):null}function Xt(e){var n=e.goBack,t=e.submitClose,r=e.name,c=e.channelId,i=e.guildId;function a(){return(a=Object(A.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(),e.next=3,Yt(i,c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)(ae.f,{fontWeight:"bold",pb:"0",children:"Delete Channel"}),Object(y.jsx)(ae.b,{pb:3,children:Object(y.jsxs)(se.a,{children:["Are you sure you want to delete #",r,"? This cannot be undone."]})}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{mr:6,variant:"link",onClick:n,fontSize:"14px",children:"Cancel"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{colorScheme:"red",fontSize:"14px",onClick:function(){return a.apply(this,arguments)},children:"Delete Channel"})})]})]})}function er(e){var n=e.channel,t=e.guildId,r="/channels/".concat(t,"/").concat(n.id),c=Object(_.h)().pathname===r,a=Object(i.useState)(!1),l=Object(T.a)(a,2),u=l[0],d=l[1],b=O((function(e){return e.current})),j=gn(t),h=Object(D.a)(),x=h.isOpen,f=h.onOpen,p=h.onClose,g=Object(s.useQueryClient)();return Object(i.useEffect)((function(){n.hasNotification&&c&&g.setQueryData(re(t),(function(e){var t=null===e||void 0===e?void 0:e.findIndex((function(e){return e.id===n.id}));return-1!==t&&(e[t]=Object(xe.a)(Object(xe.a)({},e[t]),{},{hasNotification:!1})),e}))})),Object(y.jsx)(o.b,{to:r,children:Object(y.jsxs)(Bn.c,{p:"5px",m:"0 10px",color:c||n.hasNotification?"#fff":"brandGray.accent",_hover:{bg:"brandGray.light",borderRadius:"5px",cursor:"pointer",color:"#fff"},bg:c?"brandGray.active":void 0,mb:"2px",onMouseLeave:function(){return d(!1)},onMouseEnter:function(){return d(!0)},children:[n.hasNotification&&Object(y.jsx)(Hn,{}),Object(y.jsxs)(E.a,{align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(Ve.a,{as:n.isPublic?mn.d:mn.g,color:"brandGray.accent"}),Object(y.jsx)(se.a,{ml:"2",children:n.name})]}),(null===b||void 0===b?void 0:b.id)===(null===j||void 0===j?void 0:j.ownerId)&&(u||x)&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(Ve.a,{as:yn.c,color:"brandGray.accent",fontSize:"12px",_hover:{color:"#fff"},onClick:function(e){e.preventDefault(),f()}}),x&&Object(y.jsx)($t,{guildId:t,channelId:n.id,isOpen:x,onClose:p})]})]})]})})}var nr=t(627),tr=t(374),rr=t(375),cr=oe.d().shape({nickname:oe.f().nullable().min(3).max(30),color:oe.f().nullable().matches(/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i,"The color must be a valid hex color")});function ir(e){var n=e.guildId,t=e.isOpen,r=e.onClose,c=O((function(e){return e.current})),i=Object(s.useQuery)("settings-".concat(n),(function(){return(e=n,U.get("/guilds/".concat(e,"/member"))).then((function(e){return e.data}));var e})).data;function a(){return(a=Object(A.a)(R.a.mark((function e(t,c){var i,a,s;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.setErrors,a=c.setFieldValue,e.prev=1,"#fff"===t.color&&a("color",null),e.next=5,en(n,t);case 5:s=e.sent,s.data&&r(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),i(ie(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}return i?Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{color:i.color,nickname:i.nickname},validationSchema:cr,onSubmit:function(e,n){return a.apply(this,arguments)},children:function(e){var n,t,i=e.isSubmitting,a=e.setFieldValue,s=e.values;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{fontWeight:"bold",pb:0,children:"Change Appearance"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(ye,{color:null!==(n=s.color)&&void 0!==n?n:void 0,label:"nickname",name:"nickname",value:null!==(t=s.nickname)&&void 0!==t?t:null===c||void 0===c?void 0:c.username}),Object(y.jsx)(se.a,{mt:"2",ml:"1",color:"brandGray.accent",_hover:{cursor:"pointer",color:"highlight.standard"},fontSize:"14px",onClick:function(){return a("nickname",null)},children:"Reset Nickname"}),Object(y.jsx)(V.a,{my:"4"}),Object(y.jsx)(rr.a,{color:s.color||"#fff",onChangeComplete:function(e){e&&a("color",e.hex)},className:"picker"}),Object(y.jsx)(se.a,{mt:"2",ml:"1",color:"brandGray.accent",_hover:{cursor:"pointer",color:"highlight.standard"},fontSize:"14px",onClick:function(){return a("color","#fff")},children:"Reset Color"})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:i,fontSize:"14px",children:"Save"})]})]})}})})]}):null}var ar=t(373),sr=t(268),or={"&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{width:"4px"},"&::-webkit-scrollbar-thumb":{background:"brandGray.darker",borderRadius:"18px"}};function lr(e){var n=e.guildId,t=e.isOpen,r=e.onClose,c=gn(n),a=Object(i.useState)("START"),s=Object(T.a)(a,2),o=s[0],l=s[1],u=Object(i.useState)(!1),d=Object(T.a)(u,2),b=d[0],j=d[1],h=function(){return l("START")},x=Object(D.a)(),f=x.isOpen,O=x.onOpen,p=x.onClose,g=Object(i.useRef)(null),m=Object(i.useState)(""),v=Object(T.a)(m,2),w=v[0],C=v[1],k=Object(i.useState)(""),S=Object(T.a)(k,2),I=S[0],z=S[1],_=Object(i.useState)(null),G=Object(T.a)(_,2),Q=G[0],L=G[1];function q(){return(q=Object(A.a)(R.a.mark((function e(t,c){var i,a,s,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.setErrors,a=c.resetForm,e.prev=1,(s=new FormData).append("name",t.name),s.append("image",null!==Q&&void 0!==Q?Q:w),e.next=7,$e(n,s);case 7:o=e.sent,o.data&&(a(),r()),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),i(ie(e.t0));case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function B(){return U.apply(this,arguments)}function U(){return(U=Object(A.a)(R.a.mark((function e(){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(c.id);case 2:n=e.sent,n.data&&j(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return c?Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),"START"===o&&Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)($.b,{initialValues:{name:null===c||void 0===c?void 0:c.name},validationSchema:$n,onSubmit:function(e,n){return q.apply(this,arguments)},children:function(e){var n=e.isSubmitting;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",pb:0,children:"Server Overview"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsxs)(E.a,{mb:"4",justify:"center",children:[Object(y.jsxs)(M.a,{textAlign:"center",children:[Object(y.jsx)(P.a,{label:"Change Icon","aria-label":"Change Icon",children:Object(y.jsx)(F.a,{size:"xl",name:null===c||void 0===c?void 0:c.name,bg:"brandGray.darker",color:"#fff",src:(null===c||void 0===c?void 0:c.icon)||"",_hover:{cursor:"pointer",opacity:.5},onClick:function(){return g.current.click()}})}),Object(y.jsx)(se.a,{mt:"2",_hover:{cursor:"pointer",color:"brandGray.accent"},onClick:function(){L(null),C(null)},children:"Remove"})]}),Object(y.jsx)("input",{type:"file",name:"image",accept:"image/*",ref:g,hidden:!0,onChange:function(){var e=Object(A.a)(R.a.mark((function e(n){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.currentTarget.files){e.next=2;break}return e.abrupt("return");case 2:z(URL.createObjectURL(n.currentTarget.files[0])),O();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})]}),Object(y.jsx)(ye,{label:"server name",name:"name"}),Object(y.jsx)(V.a,{my:"4"}),Object(y.jsx)(se.a,{fontWeight:"semibold",mb:2,children:"Additional Configuration"}),Object(y.jsxs)(E.a,{align:"center",justify:"space-between",mb:"2",children:[Object(y.jsx)(N.a,{onClick:B,fontSize:"14px",rightIcon:b?Object(y.jsx)(sr.a,{}):Object(y.jsx)(Ot.b,{}),colorScheme:b?"green":"gray",children:"Invalidate Links"}),Object(y.jsx)(N.a,{onClick:function(){return l("BANLIST")},fontSize:"14px",rightIcon:Object(y.jsx)(ar.a,{}),children:"Bans"})]}),Object(y.jsx)(E.a,{align:"center",justify:"space-between",mb:"2",children:Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{onClick:function(){return l("CONFIRM")},colorScheme:"red",variant:"ghost",fontSize:"14px",textColor:"menuRed",rightIcon:Object(y.jsx)(mn.e,{}),children:"Delete Server"})})})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,mr:6,variant:"link",fontSize:"14px",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:n,fontSize:"14px",children:"Save Changes"})]})]})}}),f&&Object(y.jsx)(Ge,{isOpen:f,onClose:p,initialImage:I,applyCrop:function(e){C(URL.createObjectURL(e)),L(new File([e],"icon")),p()}})]}),"CONFIRM"===o&&Object(y.jsx)(ur,{goBack:h,submitClose:function(){l("START"),r()},name:null===c||void 0===c?void 0:c.name,guildId:n}),"BANLIST"===o&&Object(y.jsx)(dr,{goBack:h,guildId:n})]}):null}function ur(e){var n=e.goBack,t=e.submitClose,r=e.name,c=e.guildId;function i(){return(i=Object(A.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(),e.next=3,Xe(c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsxs)(ae.f,{fontWeight:"bold",pb:"0",children:["Delete ",r]}),Object(y.jsx)(ae.b,{pb:3,children:Object(y.jsxs)(se.a,{children:["Are you sure you want to delete ",Object(y.jsx)("b",{children:r}),"? This cannot be undone."]})}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{mr:6,variant:"link",onClick:n,fontSize:"14px",children:"Cancel"}),Object(y.jsx)(W.c,{children:Object(y.jsx)(N.a,{colorScheme:"red",fontSize:"14px",onClick:function(){return i.apply(this,arguments)},children:"Delete Server"})})]})]})}function dr(e){var n=e.goBack,t=e.guildId,r="bans-".concat(t),c=Object(s.useQuery)(r,(function(){return(e=t,U.get("guilds/".concat(e,"/bans"))).then((function(e){return e.data}));var e})).data,i=Object(s.useQueryClient)(),a=function(){var e=Object(A.a)(R.a.mark((function e(n){var c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rn(t,n);case 2:c=e.sent,c.data&&i.setQueryData(r,(function(e){return null===e||void 0===e?void 0:e.filter((function(e){return e.id!==n}))}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(y.jsxs)(ae.d,{bg:"brandGray.light",maxH:"500px",children:[Object(y.jsxs)(ae.f,{fontWeight:"bold",pb:"0",children:[null===c||void 0===c?void 0:c.length," Bans"]}),Object(y.jsxs)(ae.b,{pb:3,overflowY:"auto",css:or,children:[Object(y.jsx)(se.a,{mb:2,children:"Bans are by account. Click on the icon to unban."}),null===c||void 0===c?void 0:c.map((function(e){return Object(y.jsxs)(E.a,{p:"3",_hover:{bg:"brandGray.dark",borderRadius:"5px"},align:"center",justify:"space-between",children:[Object(y.jsxs)(E.a,{align:"center",w:"full",children:[Object(y.jsx)(F.a,{size:"sm",src:e.image}),Object(y.jsx)(se.a,{ml:"2",children:e.username})]}),Object(y.jsx)(jt.a,{icon:Object(y.jsx)(sr.b,{}),borderRadius:"50%","aria-label":"unban user",onClick:function(){var n=Object(A.a)(R.a.mark((function n(t){return R.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,a(e.id);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})]})})),0===(null===c||void 0===c?void 0:c.length)&&Object(y.jsx)(se.a,{children:"No bans yet."})]}),Object(y.jsx)(ae.e,{bg:"brandGray.dark",children:Object(y.jsx)(N.a,{mr:6,variant:"link",onClick:n,fontSize:"14px",children:"Back"})})]})}function br(e){var n=e.label,t=e.icon,r=e.handleClick;return Object(y.jsx)(nr.d,{_hover:{bg:"highlight.standard",borderRadius:"2px"},onClick:r,children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",w:"full",children:[Object(y.jsx)(se.a,{children:n}),Object(y.jsx)(Ve.a,{as:t})]})})}function jr(e){var n=e.label,t=e.icon,r=e.handleClick;return Object(y.jsx)(nr.d,{_hover:{bg:"menuRed",color:"#fff",borderRadius:"2px"},onClick:r,children:Object(y.jsxs)(E.a,{align:"center",justify:"space-between",w:"full",children:[Object(y.jsx)(se.a,{children:n}),Object(y.jsx)(Ve.a,{as:t})]})})}function hr(e){var n=e.children;return Object(y.jsx)(nr.e,{bg:"brandGray.darkest",px:"2",children:n})}function xr(e){var n=e.channelOpen,t=e.inviteOpen,r=Object(_.i)().guildId,c=gn(r),i=Object(_.g)(),a=Object(s.useQueryClient)(),o=O((function(e){return e.current})),l=(null===c||void 0===c?void 0:c.ownerId)===(null===o||void 0===o?void 0:o.id),u=Object(D.a)(),d=u.isOpen,b=u.onOpen,j=u.onClose,h=Object(D.a)(),x=h.isOpen,f=h.onOpen,p=h.onClose,g=function(){var e=Object(A.a)(R.a.mark((function e(){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t=r,U.delete("guilds/".concat(t));case 2:n=e.sent,n.data&&(a.setQueryData(X,(function(e){return e.filter((function(e){return e.id!==(null===c||void 0===c?void 0:c.id)}))})),i.replace("/channels/me"));case 5:case"end":return e.stop()}var t}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsxs)(Ee.b,{gridColumn:2,gridRow:"1",bg:"brandGray.light",padding:"10px",zIndex:"2",boxShadow:"md",children:[Object(y.jsx)(nr.a,{placement:"bottom-end",isLazy:!0,children:function(e){var r=e.isOpen;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(E.a,{justify:"space-between",align:"center",children:[Object(y.jsx)(L.a,{fontSize:"20px",children:null===c||void 0===c?void 0:c.name}),Object(y.jsx)(nr.b,{children:Object(y.jsx)(Ve.a,{as:r?vn.d:vn.a})})]}),Object(y.jsxs)(hr,{children:[Object(y.jsx)(br,{label:"Invite People",icon:mn.h,handleClick:t}),l&&Object(y.jsx)(br,{label:"Server Settings",icon:St.a,handleClick:b}),l&&Object(y.jsx)(br,{label:"Create Channel",icon:yn.a,handleClick:n}),Object(y.jsx)(nr.c,{}),Object(y.jsx)(br,{label:"Change Appearance",icon:mn.f,handleClick:f}),!l&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(nr.c,{}),Object(y.jsx)(jr,{label:"Leave Server",icon:tr.a,handleClick:g})]})]})]})}}),d&&Object(y.jsx)(lr,{guildId:r,isOpen:d,onClose:j}),x&&Object(y.jsx)(ir,{guildId:r,isOpen:x,onClose:p})]})}function fr(e){var n=e.guildId,t=e.isOpen,r=e.onClose,c=ce(n),a=Object(s.useQuery)(c,(function(){return Ke(n).then((function(e){return e.data}))})).data;function o(){return(o=Object(A.a)(R.a.mark((function e(t,c){var i,a,s,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.setErrors,a=c.resetForm,e.prev=1,s=[],b.map((function(e){return s.push(e.value)})),e.next=6,Ut(n,Object(xe.a)(Object(xe.a)({},t),{},{members:s}));case 6:o=e.sent,o.data&&(a(),r()),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),i(ie(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}var l=[],u=Object(i.useState)([]),d=Object(T.a)(u,2),b=d[0],j=d[1];null===a||void 0===a||a.map((function(e){return l.push({label:e.username,value:e.id,image:e.image})}));var h=function(e){j((function(n){return[].concat(Object(Ne.a)(n),[e])}))},x=function(e){return Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(F.a,{mr:2,size:"sm",src:e.image}),Object(y.jsx)(se.a,{textColor:"#000",children:e.label})]})};return Object(y.jsxs)(ae.a,{isOpen:t,onClose:r,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsx)(ae.d,{bg:"brandGray.light",children:Object(y.jsx)($.b,{initialValues:{name:"",isPublic:!0},validationSchema:Kt,onSubmit:function(e,n){return o.apply(this,arguments)},children:function(e){var n=e.isSubmitting,t=e.setFieldValue,c=e.values;return Object(y.jsxs)($.a,{children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",children:"Create Text Channel"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(ye,{label:"channel name",name:"name"}),Object(y.jsxs)(Oe.a,{display:"flex",alignItems:"center",justifyContent:"space-between",mt:"4",children:[Object(y.jsx)(pe.a,{htmlFor:"email-alerts",mb:"0",children:Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(tt.b,{}),Object(y.jsx)(se.a,{ml:"2",children:"Private Channel"})]})}),Object(y.jsx)(Zt.a,{onChange:function(e){t("isPublic",!e.target.checked)}})]}),Object(y.jsx)(se.a,{mt:"4",fontSize:"14px",textColor:"brandGray.accent",children:"By making a channel private, only selected members will be able to view this channel"}),!c.isPublic&&Object(y.jsx)(M.a,{mt:"2",pb:0,children:Object(y.jsx)(Jt.CUIAutoComplete,{label:"Who can access this channel",placeholder:"",onCreateItem:h,items:l,selectedItems:b,itemRenderer:x,onSelectedItemsChange:function(e){return function(e){e&&j(e)}(e.selectedItems)}})})]}),Object(y.jsxs)(ae.e,{bg:"brandGray.dark",children:[Object(y.jsx)(N.a,{onClick:r,fontSize:"14px",mr:6,variant:"link",children:"Cancel"}),Object(y.jsx)(N.a,{background:"highlight.standard",color:"white",type:"submit",fontSize:"14px",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},isLoading:n,children:"Create Channel"})]})]})}})})]})}var Or=t(631);function pr(e){var n=e.isOpen,t=e.onClose,r=Object(_.i)().guildId,c=Object(i.useState)(""),a=Object(T.a)(c,2),s=a[0],o=a[1],l=Object(lt.a)(s),u=l.hasCopied,d=l.onCopy,b=Object(i.useState)(!1),j=Object(T.a)(b,2),h=j[0],x=j[1];return Object(i.useEffect)((function(){if(n){var e=function(){var e=Object(A.a)(R.a.mark((function e(){var n,t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze(r,h);case 2:n=e.sent,(t=n.data)&&o(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[n,r,h]),Object(y.jsxs)(ae.a,{isOpen:n,onClose:t,isCentered:!0,children:[Object(y.jsx)(ae.g,{}),Object(y.jsxs)(ae.d,{bg:"brandGray.light",children:[Object(y.jsx)(ae.f,{textAlign:"center",fontWeight:"bold",pb:"0",children:"Invite Link"}),Object(y.jsx)(ae.c,{}),Object(y.jsxs)(ae.b,{children:[Object(y.jsx)(se.a,{mb:"4",children:"Share this link with others to grant access to this server"}),Object(y.jsx)(Or.a,{onChange:function(e){return x(e.target.checked)},mb:4,children:"Make it unlimited / Never reset"}),Object(y.jsxs)(Dn.a,{children:[Object(y.jsx)(ge.a,{bg:"brandGray.dark",borderColor:u?"brandGreen":"black",borderRadius:"3px",focusBorderColor:"highlight.standard",value:s,isReadOnly:!0}),Object(y.jsx)(Ln.b,{width:"4.5rem",children:Object(y.jsx)(N.a,{h:"1.75rem",size:"sm",bg:u?"brandGreen":"highlight.standard",color:"white",type:"submit",fontSize:"14px",_hover:{bg:"highlight.hover"},_active:{bg:"highlight.active"},_focus:{boxShadow:"none"},onClick:d,children:u?"Copied":"Copy"})})]}),Object(y.jsx)(se.a,{my:"2",fontSize:"12px",children:h?"Your invite link won't expire":"Your invite link expires in 1 day and can only be used once"})]}),Object(y.jsx)(ae.e,{bg:"brandGray.dark"})]})]})}function gr(){var e=Object(D.a)(),n=e.isOpen,t=e.onOpen,r=e.onClose,c=Object(D.a)(),a=c.isOpen,o=c.onOpen,l=c.onClose,u=Object(_.i)().guildId,d=re(u),b=Object(s.useQuery)(d,(function(){return(e=u,U.get("/channels/".concat(e))).then((function(e){return e.data}));var e})).data;return function(e,n){var t=Object(_.h)(),r=Object(_.g)(),c=Object(s.useQueryClient)(),a=gn(e);Object(i.useEffect)((function(){var i=m();i.emit("joinGuild",e);var s=function(){i.emit("leaveGuild",e),i.disconnect()};return i.on("add_channel",(function(e){c.invalidateQueries(n)})),i.on("edit_channel",(function(e){c.setQueryData(n,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e.id}));return-1!==t?n[t]=e:e.isPublic&&n.push(e),n}))})),i.on("delete_channel",(function(i){c.setQueryData(n,(function(n){var c="/channels/".concat(e,"/").concat(i);return t.pathname===c&&a&&(i===a.default_channel_id?r.replace("/channels/me"):r.replace("".concat(a.default_channel_id))),null===n||void 0===n?void 0:n.filter((function(e){return e.id!==i}))}))})),i.on("new_notification",(function(r){var i="/channels/".concat(e,"/").concat(r);t.pathname!==i&&c.setQueryData(n,(function(e){var n=null===e||void 0===e?void 0:e.findIndex((function(e){return e.id===r}));return-1!==n&&(e[n]=Object(xe.a)(Object(xe.a)({},e[n]),{},{hasNotification:!0})),e}))})),window.addEventListener("beforeunload",s),function(){return s()}}),[e,n,c,r,t,a])}(u,d),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(xr,{channelOpen:o,inviteOpen:t}),Object(y.jsxs)(Ee.b,{gridColumn:2,gridRow:"2/4",bg:"brandGray.dark",overflowY:"hidden",_hover:{overflowY:"auto"},css:or,children:[n&&Object(y.jsx)(pr,{isOpen:n,onClose:r}),a&&Object(y.jsx)(fr,{guildId:u,onClose:l,isOpen:a}),Object(y.jsxs)(Bn.e,{listStyleType:"none",ml:"0",mt:"4",children:[null===b||void 0===b?void 0:b.map((function(e){return Object(y.jsx)(er,{channel:e,guildId:u},e.id)})),Object(y.jsx)(M.a,{h:"16"})]}),Object(y.jsx)(It,{})]})]})}function mr(e){var n=e.member,t=Object(_.i)().guildId,r=O((function(e){return e.current})),c=gn(t),i=void 0!==c&&c.ownerId===(null===r||void 0===r?void 0:r.id),a=Object(sn.d)({id:n.id}).show;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(Bn.c,{p:"2",mx:"10px",color:"brandGray.accent",_hover:{bg:"brandGray.light",borderRadius:"5px",cursor:"pointer",color:"#fff"},onContextMenu:a,children:Object(y.jsxs)(E.a,{align:"center",children:[Object(y.jsx)(F.a,{size:"sm",src:n.image,children:Object(y.jsx)(F.b,{boxSize:"1.25em",bg:n.isOnline?"green.500":"gray.500"})}),Object(y.jsx)(se.a,{ml:"2",children:n.username})]})}),n.id!==(null===r||void 0===r?void 0:r.id)&&Object(y.jsx)(on,{member:n,id:n.id,isOwner:i})]})}var vr={"&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{width:"4px"},"&::-webkit-scrollbar-thumb":{background:"brandGray.darker",borderRadius:"18px"}};function yr(){var e=Object(_.i)().guildId,n=ce(e),t=Object(s.useQuery)(n,(function(){return Ke(e).then((function(e){return e.data}))})).data,r=[],c=[];return t&&t.forEach((function(e){e.isOnline?r.push(e):c.push(e)})),function(e,n){var t=Object(s.useQueryClient)();Object(i.useEffect)((function(){var r=m();return r.emit("joinGuild",e),r.on("add_member",(function(e){t.setQueryData(n,(function(n){return[].concat(Object(Ne.a)(n),[e]).sort((function(e,n){return e.username.localeCompare(n.username)}))}))})),r.on("remove_member",(function(e){t.setQueryData(n,(function(n){return Object(Ne.a)(null===n||void 0===n?void 0:n.filter((function(n){return n.id!==e})))}))})),r.on("toggle_online",(function(e){t.invalidateQueries(n)})),r.on("toggle_offline",(function(e){t.setQueryData(n,(function(n){var t=null===n||void 0===n?void 0:n.findIndex((function(n){return n.id===e}));return-1!==t&&(n[t].isOnline=!1),n}))})),function(){r.emit("leaveRoom",e),r.disconnect()}}),[n,t,e])}(e,n),Object(y.jsx)(Ee.b,{gridColumn:4,gridRow:"1 / 4",bg:"memberList",overflowY:"hidden",_hover:{overflowY:"auto"},css:vr,children:Object(y.jsxs)(Bn.e,{listStyleType:"none",ml:"0",children:[Object(y.jsx)(xt,{label:"online\u2014".concat(r.length)}),r.map((function(e){return Object(y.jsx)(mr,{member:e},e.id)})),Object(y.jsx)(xt,{label:"offline\u2014".concat(c.length)}),c.map((function(e){return Object(y.jsx)(mr,{member:e},e.id)}))]})})}function wr(){var e=Wt((function(e){return e.showMembers}));return Object(y.jsxs)(Me,{showLastColumn:e,children:[Object(y.jsx)(ot,{}),Object(y.jsx)(gr,{}),Object(y.jsx)(Bt,{}),Object(y.jsx)(Qn,{}),Object(y.jsx)(Vn,{}),e&&Object(y.jsx)(yr,{})]})}function Cr(){return Object(y.jsxs)(_.d,{children:[Object(y.jsx)(_.b,{exact:!0,path:"/",component:Pt}),Object(y.jsx)(_.b,{path:"/login",component:Ft}),Object(y.jsx)(_.b,{path:"/register",component:qt}),Object(y.jsx)(_.b,{path:"/forgot-password",component:De}),Object(y.jsx)(_.b,{path:"/reset-password/:token",component:Nt}),Object(y.jsx)(Te,{exact:!0,path:"/channels/me",component:Gt}),Object(y.jsx)(Te,{exact:!0,path:"/channels/me/:channelId",component:Gt}),Object(y.jsx)(Te,{exact:!0,path:"/channels/:guildId/:channelId",component:wr}),Object(y.jsx)(Te,{exact:!0,path:"/account",component:Re}),Object(y.jsx)(Te,{exact:!0,path:"/:link",component:At})]})}z.a.render(Object(y.jsx)(S,{children:Object(y.jsx)(Cr,{})}),document.getElementById("root"))}},[[585,1,2]]]);
//# sourceMappingURL=main.d10d6c1d.chunk.js.map